let T=b;function a(){let e=["Bw9KzxjH","zxjHDgLV","ndGYy0fpCxL5","C2XPy2u","qw50Au1H","BMCGkef1","uMvHC29U","zgvSzxrL","BwvTyMvY","yxbWBhLP","rMfPBgvK","jsvFx1vt","zvnWyw0","twvZC2fN","Dg8Gtw9K","BMCGC3bH","AgfUzgXP","zMLYC3rn","AgfZ","DxnLCNm","BgvUz3rO","C2vUza","zgXLCNmV","DxnLCM5H","rdOG","BNrPu3bH","AvHMr0K","z3vPBgq","mty1nde5mZbnAezeCge","qw50AvnW","rxjYB3iG","vgLTzuXP","mte1nZC1tKrxEvLZ","ihrVigrL","y29Kzq","Dfvfuwi","zensBw8","BMfTzq","ChvZAa","Bsb0Aw1L","yxv0Ag9Y","Bgv0zsbT","z2v0","vxnLCIbj","lI4Vy29Y","rw5HyMXL","yxrPB24P","zM9YrwfJ","ywrKB25m","wfbIteK","ihvZzxjZ","Cenev0O","mZe4DgzPDMLx","DgLTzw91","u3bHBw1P","y3rPB246","zw50CMLL","y2HHBM5L","CMvWBgfJ","yw5UzwXj","zxjYB3i","ugvYBxm","rgLYzwn0","y3vzBvu","DfrPBwu","qxv0BYbn","zvv0AwXZ","mJG2nZG2mMTrz0rmvW","nJu1ovvkyuDZta","mJryvvvosg4","z2v0rxzL","u3bHBsbe","C2L6zq","Aw9U","ie1VzgvY","u2vUzern","tg9NC0nO","zw91Da","DKLKEKG","Bgv0zq","BM93","icHbDxrV","EwvAquW","qNLWyxnZ","mJu2otKZmwjTsxfWDq","zs9JB25M","yNvSA0rL","BMCGDgLT","BMCGtwvZ","DfvXBw8","mZm3mZK0mhzTwhPSCa","BwvZC2fN","z2vY","B2fKzxi","vgLTzw91","shDpqLu","kIPvC2vY","ntG0mtiXnNjNyvfAuG","zxnZywDL","z2vZigLU","C3nnzw50","BxnNq291","C2fNztOG","zgvSzxrP","BNrnyw5H","C29YDa","Bw9KzwXZ","twfZCYbn","y2f0y2G","zw50Aw9U","t25L","B3v0oIa","uM9Szxm","C2v0","rxHWAxjL","ierLDgvJ","B2rLCMf0","zNjVBq","Bw1XEg4","DxbKyxrL"];return(a=function(){return e})()}(()=>{for(var e=b,n=a();;)try{if(813835==-parseInt(e(338))*(-parseInt(e(392))/2)+parseInt(e(337))/3+-parseInt(e(360))/4+parseInt(e(422))/5*(parseInt(e(442))/6)+-parseInt(e(354))/7*(parseInt(e(339))/8)+parseInt(e(367))/9+-parseInt(e(418))/10)break;n.push(n.shift())}catch(e){n.push(n.shift())}})();let UserData=require("../../"+T(376)+"/UserData"),{hasPermissionOrRole,parseDuration,humanReadableDuration,getTimeoutExpiryTimestamp,createLogEmbed,sendLogMessage,sendDirectMessage}=require("../han"+T(412)+T(361)+T(336)),getConfig=require(T(434)+T(355)+"igLoader").getConfig,config=getConfig(),parsedSpamTimeLimit=parseDuration(config.AntiSpam[T(421)+"mit"]),parsedSpamTimeout=parseDuration(config.AntiSpam[T(364)+T(454)]),spamData=new Map,MAX_SPAM_ENTRIES=1e3,SPAM_DATA_TTL=6e4;function b(i,e){let r=a();return(b=function(e,n){e-=336;let t=r[e];void 0===b.aaqlRP&&(b.xlfguE=function(i){let r="",t="";for(let e=0,n,t,a=0;t=i.charAt(a++);~t&&(n=e%4?64*n+t:t,e++%4)&&(r+=String.fromCharCode(255&n>>(-2*e&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(let e=0,n=r.length;e<n;e++)t+="%"+("00"+r.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)},i=arguments,b.aaqlRP=!0);var e=e+r[0],a=i[e];return a?t=a:(t=b.xlfguE(t),i[e]=t),t})(i,e)}async function checkAntiMassMention(a){let i=T,u={KbUTb:function(e,n){return e-n},cQvQL:"Spamming (Auto Moderation)",oFCcc:function(e,n){return e(n)},sryHy:function(e,n,t,a){return e(n,t,a)},XPbLI:i(401)+"ER__%%",CkjcP:"MxlvS",HVHMH:function(e,n,t){return e(n,t)},bgvKC:function(e,n){return e(n)},vIdzH:"massMention",pCDWJ:i(443)+"t",yudcb:i(377)+i(379),cjKhk:"Mentions"};if(config[i(394)+"ssMention"][i(435)+"d"]){var g=u.sryHy(hasPermissionOrRole,a[i(398)],config[i(394)+i(370)+"ion"][i(353)+"Perms"],config["AntiMassMent"+i(343)]["Bypass"+i(382)]);if(!g&&a.mentions[i(409)][i(342)]>config[i(394)+"ssMent"+i(343)].Amount){try{if("MhDwo"===i(365)){let t=n[i(350)]();for(var[c,f]of y[i(446)+"s"]())u.KbUTb(t,f["firstM"+i(368)])>B&&D[i(397)](c);if(r.size>s){let e=E[i(387)](F.entries())[i(375)]((e,n)=>e[1][i(407)+i(368)]-n[1][i(407)+"essage"]),n=e[i(393)](0,G.size-H);n.forEach(([e])=>t.delete(e))}}else await a.delete()}catch(e){e[i(424)]===u[i(439)]?console.error(i(400)+i(423)+"lete m"+i(368)+":",e):"MxlvS"!==u.CkjcP?l[i(438)+"oader"][i(340)+i(374)+"ger"]().emitSafe("moderation:a"+i(415)+"m",{type:"messageSpam",user:m.author,member:n[i(398)],guild:o.guild,channel:p.channel,action:i(443)+"t",duration:q,reason:u.cQvQL,messageCount:r.msgCount,timeWindow:u.oFCcc(s,t)}):console[i(450)](i(420)+i(373)+"ng mes"+i(372)+e)}let e=await a[i(447)+"l"].send(config[i(394)+i(370)+"ion"].Message[i(448)+"e"](/{user}/g,"<@"+a[i(430)].id+">"));if(u.HVHMH(setTimeout,()=>e.delete()[i(378)](console[i(450)]),3e3),!0===config[i(394)+i(370)+i(343)].TimeoutUser){g=u.bgvKC(parseDuration,config[i(394)+"ssMent"+i(343)].TimeoutTime);try{await a[i(398)][i(443)+"t"](g,i(377)+"ention"+i(351)+i(344)+i(436)),await UserData[i(389)+i(380)]({userId:a.author.id,guildId:a[i(417)].id},{$inc:{timeouts:1}}),global["addonL"+i(363)]&&global.addonLoader["getEventMana"+i(362)]().emitSafe("moderation:a"+i(415)+"m",{type:u[i(348)],user:a.author,member:a.member,guild:a[i(417)],channel:a.channel,message:a,action:u[i(441)],duration:g,reason:i(377)+i(379)+i(351)+" Moderation)",mentionCount:a.mentions.users[i(342)]});var d=createLogEmbed(i(455)+"oderation","Red",i(377)+i(379)+i(385)+"ted","**User:** <@"+a.author.id+"> \n**Action:** Tim"+i(347),[{name:"Reason",value:u.yudcb,inline:!0},{name:"Expires",value:getTimeoutExpiryTimestamp(g),inline:!0},{name:u.cjKhk,value:a.mentions[i(409)].size+i(440),inline:!0}],"User ID: "+a[i(430)].id);if(sendLogMessage(a[i(417)],config[i(394)+i(370)+i(343)][i(346)+"annelID"],d),config["AntiMa"+i(370)+"ion"][i(345)]){let e={user:a[i(430)][i(413)+"me"],time:config["AntiMa"+i(370)+i(343)]["Timeou"+i(454)]};await sendDirectMessage(a.author,config[i(394)+i(370)+"ion"][i(452)+"Message"],e)}}catch(e){console.error(i(420)+i(399)+i(357)+"eout:",e)}}}}}async function checkAntiSpam(n){let t=T,a={mmqxn:function(e,n,t,a){return e(n,t,a)},yeZAL:function(e,n){return e-n},iXfGI:function(e,n){return n<e},cuYmU:function(e,n,t,a,i,r,s){return e(n,t,a,i,r,s)},tUEQb:t(384)+"s",oNzBG:function(e,n){return e(n)}};if(config.AntiSpam.Enabled){var e=a[t(388)](hasPermissionOrRole,n.member,config[t(419)+"am"]["Bypass"+t(451)],config.AntiSpam[t(353)+t(382)]);if(!e){var e=Date[t(350)](),i=parsedSpamTimeLimit;if(spamData[t(408)](n[t(430)].id)){var r=spamData[t(432)](n[t(430)].id);if(a[t(352)](e,r[t(407)+"essage"])<i){if(r[t(371)+"nt"]++,r.messages[t(428)](n.id),a[t(416)](r[t(361)+"es"][t(410)],20)&&(r[t(361)+"es"]=r[t(361)+"es"].slice(-10)),spamData[t(383)](n.author.id,r),r.msgCount>=config.AntiSpam.MsgLimit){var s=parsedSpamTimeout;try{let e=await n.channel[t(411)](config.AntiSpam.Message.replace(/{user}/g,"<@"+n.author.id+">"));setTimeout(()=>e[t(397)]()[t(378)](console.error),3e3),await n[t(398)][t(443)+"t"](s,t(444)+t(395)+t(404)+t(391)+"n)"),await UserData[t(389)+t(380)]({userId:n.author.id,guildId:n[t(417)].id},{$inc:{timeouts:1}}).catch(console.error),global[t(438)+"oader"]&&global[t(438)+t(363)][t(340)+"ntMana"+t(362)]().emitSafe(t(390)+"tion:antiSpam",{type:"messag"+t(402),user:n.author,member:n.member,guild:n.guild,channel:n[t(447)+"l"],action:t(443)+"t",duration:s,reason:t(444)+t(395)+t(404)+"eration)",messageCount:r[t(371)+"nt"],timeWindow:humanReadableDuration(i)});var o,m=a[t(453)](createLogEmbed,"Auto M"+t(386)+"ion","Red",t(341)+"etected",t(366)+":** <@"+n[t(430)].id+"> \n**A"+t(445)+"** Timeout",[{name:t(396),value:"Spammi"+t(358)+"sages",inline:!0},{name:a[t(425)],value:getTimeoutExpiryTimestamp(s),inline:!0},{name:t(403)+"es",value:r.msgCount+(" messa"+t(369))+" "+a.oNzBG(humanReadableDuration,i),inline:!0}],t(433)+t(414)+n.author.id);sendLogMessage(n.guild,config[t(419)+"am"][t(346)+t(449)+"D"],m),config.AntiSpam.SendDM&&(o={user:n[t(430)].username,guildName:n[t(417)][t(427)],messageContent:n.content,time:config.AntiSpam[t(364)+"tTime"]},await sendDirectMessage(n.author,config.AntiSpam[t(452)+"Message"],o));try{await n[t(447)+"l"][t(356)+t(349)](r.messages)[t(378)](console[t(450)])}catch(e){console.error(t(400)+" to de"+t(431)+"essages:",e)}}catch(e){console[t(450)](t(420)+t(406)+t(405)+t(429)+t(381)+e)}spamData.delete(n[t(430)].id)}}else spamData.set(n[t(430)].id,{msgCount:1,firstMessage:e,messages:[n]})}else spamData[t(383)](n.author.id,{msgCount:1,firstMessage:e,messages:[n.id]})}}}setInterval(()=>{let t=T,e={tUqmo:function(e,n){return n<e},dCRmo:function(e,n){return e-n}},n=Date.now();for(var[a,i]of spamData.entries())e[t(359)](n-i[t(407)+"essage"],SPAM_DATA_TTL)&&spamData.delete(a);spamData.size>MAX_SPAM_ENTRIES&&Array.from(spamData[t(446)+"s"]()).sort((e,n)=>e[1][t(407)+"essage"]-n[1][t(407)+t(368)])[t(393)](0,e[t(426)](spamData[t(342)],MAX_SPAM_ENTRIES))[t(437)+"h"](([e])=>spamData[t(397)](e))},3e4),module.exports={checkAntiMassMention:checkAntiMassMention,checkAntiSpam:checkAntiSpam};