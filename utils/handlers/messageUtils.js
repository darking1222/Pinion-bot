let P=b;function b(i,e){let o=a();return(b=function(e,t){e-=457;let n=o[e];void 0===b.dSDGuW&&(b.fKhNfu=function(i){let a="",n="";for(let e=0,t,n,r=0;n=i.charAt(r++);~n&&(t=e%4?64*t+n:n,e++%4)&&(a+=String.fromCharCode(255&t>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(let e=0,t=a.length;e<t;e++)n+="%"+("00"+a.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(n)},i=arguments,b.dSDGuW=!0);var e=e+o[0],r=i[e];return r?n=r:(n=b.fKhNfu(n),i[e]=n),n})(i,e)}(()=>{for(var e=b,t=a();;)try{if(263778==-parseInt(e(532))*(-parseInt(e(521))/2)+parseInt(e(496))/3+-parseInt(e(466))/4+parseInt(e(526))/5*(-parseInt(e(510))/6)+parseInt(e(470))/7*(parseInt(e(485))/8)+-parseInt(e(523))/9+parseInt(e(464))/10)break;t.push(t.shift())}catch(e){t.push(t.shift())}})();let EmbedBuilder=require("discord.js").EmbedBuilder,moment=require("moment"+P(537)+"one"),{getConfig,getLang}=require(P(483)+"e/configLoader.js"),Settings=require("../../models"+P(518)+P(515)),config=getConfig(),lang=getLang(),precompiledBlacklist=null,precompiledWhitelistWords=null,dbSettingsCache=new Map,DB_CACHE_TTL=3e4;function convertPatternToRegex(e){var t,n=P;return e[n(533)+"With"](n(528))?new RegExp(e[n(516)](6),"i"):(t=e[n(511)+"e"](/[.+?^${}()|[\]\\]/g,n(457)).replace(/\*/g,".*"),e[n(480)+"es"]("*")?new RegExp(t,"i"):new RegExp("^"+t+"$","i"))}function a(){let e=["BMfTzq","ihrVihnL","qNLWyxnZ","zxjUoIOQ","zM9YrwfJ","Aw5JBhvK","qxjOvK4","kIPuAw1L","lI4Vy29Y","BYbzwvLz","mtzMwKzdvMG","C2v0rM9V","t0nNrNu","C2v0vgLT","y2f0y2G","ufzHtuC","BM90AwzP","zgvSzxrL","kIPdAgfU","BwvTyMvY","z3vPBgq","mJKZmtCYCMjsELjJ","Bwf0y2G","sLvXz2W","BwfW","C2v0rgvZ","qMXHy2TS","BwjUywLS","s2zNBLq","zxjYB3i","Axn0v29Y","EfDOt3a","rM9VDgvY","vhLWzq","BxnYBNa","mtqYntK1ne9NDvrZza","CMvWBgfJ","CgvYBwLZ","Bg9NC0nO","zM9YBwf0","BMDZ","C2XPy2u","BM5LBhm","l1nLDhrP","zxn0yw1W","B2XVCNm","mNjIr1bmCG","BgvUz3rO","mtKZmZm4owv1tffbqq","ugvYBxm","C2v0vgL0","mtblB2XOtKm","CM9Szxm","CMvNzxG6","y2TSAxn0","oIOQia","C2v0vgH1","ndyZmJq5uwjpyLzg","C3rHCNrZ","y3jPChrP","BeT0D20","rgnHyvq","lxrPBwv6","lcbisdPT","DxnLCM5H","vuLzrMO","twvZC2fN","y2XLyxi","q0HbtK5f","zw5HyMXL","DxnLzcbH","CLvsta","DgfN","tf9jra","CxzSte4","i0zgmdaW","y2fJAgu","tu1ntsbe","thjYrM4","z2v0","zMXVB3i","kIPvC2vY","C2v0q29S","rw5HyMXL","vNjVveC","BM93","AgfUzgXP","DgvY","zgLZCgXH","AgfZ","zMXgBM8","rgvZy3jP","DgvZDa","seG6Bw0","kIPqyxr0","C2v0DgLU","BgLZDgvK","D2HPDgvS","yxv0Ag9Y","BKDxufu","C2HVCNr0","ugf0DgvY","y2HHBM5L","rxjYB3iG","Cg54y2q","y29UDgvU","Euf2yxrH","zw50CMLL","BMCGyMXH","xcqM","CgfYzw50","AfHgz0u","u1vQzLi","vgLTzxPV","C2vUza","ywLS","nJa3odq3mgnMCNDwEG","oIOQidXa","mta5oda2mgnrvvLfuG","q3L3veu","AwnVBLvs","BKjqvvy","mJa4nJqYCg9PD0nh","Cgf0DgvY","E3vZzxj9","Aw5SAw5L","vML1Dva"];return(a=function(){return e})()}async function getBlacklistSettings(n){var r=P,e={OCgFu:r(459)},t=dbSettingsCache[r(554)](n);if(t&&Date.now()-t.timestamp<DB_CACHE_TTL)return t[r(570)+"gs"];try{if("hXFgE"===e[r(487)]){let e=await Settings.findOne({guildId:n}).lean(),t=e?.blacklistWords||null;return dbSettingsCache.set(n,{settings:t,timestamp:Date[r(560)]()}),t}f[r(486)+r(562)]({text:g[r(507)].replace(/{shorttime}/g,h[r(575)+"ime"])})}catch(e){return console.error(r(578)+"fetchi"+r(583)+"cklist settings:",e),null}}function clearBlacklistCache(e){var t=P;e?dbSettingsCache[t(492)](e):dbSettingsCache[t(542)](),precompiledBlacklist=null,precompiledWhitelistWords=null}async function checkBlacklistWords(a,o=!1){let s=P,l={UihEu:function(e,t){return e(t)},REWrc:s(552)+"o YYYY",SUjfR:s(498),pnxcd:s(541)+"e",VroTG:"Embed",xWhOp:"OljaA",aNTcQ:function(e){return e()},OmlUm:"ðŸš« Blacklisted Word Detected",LrrFn:s(552)+"o YYYY"+s(538)+"m",KfgnT:function(e,t){return e===t}},c=await l.UihEu(getBlacklistSettings,a[s(495)].id),u=config[s(501)+"istWords"]?.[s(558)+"d"],g=c?.[s(544)+"d"];if(u||g){var d=config["Blackl"+s(505)+"ds"]?.[s(477)+s(524)]||[];if(!(0<d.length&&a.member[s(512)+"sions"][s(564)](d))){let i=[...config[s(501)+s(505)+"ds"]?.[s(477)+"Roles"]||[],...c?.bypassRoles||[]],e=a[s(494)][s(527)].cache.some(e=>i[s(480)+"es"](e.id));if(!e){var f,m,h,v,t=[...config["Blackl"+s(505)+"ds"]?.["WhitelistCha"+s(517)]||[],...c?.[s(572)+"istChannels"]||[]],n=[...config[s(501)+s(505)+"ds"]?.WhitelistCategories||[],...c?.whitelistCategories||[]];if(!(t[s(480)+"es"](a[s(577)+"l"].id)||a[s(577)+"l"][s(458)+"Id"]&&n.includes(a.channel[s(458)+"Id"]))){let t=a[s(580)+"t"],e=[...config["Blackl"+s(505)+"ds"]?.WhitelistWords||[],...c?.[s(572)+"istWords"]||[]],n=e.map(convertPatternToRegex),r=n.some(e=>e.test(t));if(!r){let r=null;for({pattern:f,regex:m}of[...u&&config.BlacklistWords?.[s(576)+"ns"]||[],...g&&c?.[s(471)+"ns"]||[]][s(499)](e=>({pattern:e,regex:convertPatternToRegex(e)})))if(m[s(567)](t)){r=f;break}if(r)try{await a.delete();let e=c?.[s(491)+"cation"+s(541)+"e"]||config[s(501)+"istWords"]?.Message||s(472)+", you "+s(545)+" black"+s(571)+" word!",t=e.replace(/{user}/g,"<@"+a[s(573)].id+">"),n=await a.channel.send(t);if(setTimeout(()=>n.delete().catch(console[s(504)]),3e3),config.BlacklistWords?.DM?.[s(558)+"d"]&&!o){if("flFno"!==s(565))return;{let e=moment().tz(config[s(461)+"ne"]),t={user:a.author[s(539)+"me"],blacklistedword:r,shorttime:e.format(s(568)),longtime:e.format(l.REWrc)};try{if("XwFsh"!==l[s(460)]){if(config["Blackl"+s(505)+"ds"].DM.Type===l[s(579)]){let n=config.BlacklistWords.DM[s(541)+"e"];Object.entries(t).forEach(([e,t])=>{n=n.replace(new RegExp("{"+e+"}","g"),t)}),await a.author.send(n)}else config.BlacklistWords.DM[s(508)]===l[s(559)]&&(h=config[s(501)+s(505)+"ds"].DM.Embed,v=(new EmbedBuilder)[s(557)+"or"](h.Color).setTitle(h.Title)[s(500)+"cription"](h[s(566)+"ption"][s(499)](e=>Object[s(582)+"s"](t).reduce((e,[t,n])=>e.replace(new RegExp("{"+t+"}","g"),n),e)).join("\n")),h[s(507)]&&v["setFoo"+s(562)]({text:h[s(507)].replace(/{shorttime}/g,t[s(575)+"ime"])}),h["Thumbn"+s(463)]&&v[s(531)+"mbnail"](a[s(573)].displayAvatarURL()),await a[s(573)][s(462)]({embeds:[v]}));o=!0}else u.addFields({name:g.name,value:d.value,inline:i[s(473)]||!1})}catch(e){if(50007===e.code){if("ehxAC"!==l[s(506)])return o;o.clear()}console.error("Failed to send DM:",e)}}}var C,p,B=c?.[s(513)+"annelId"]||config["Blackl"+s(505)+"ds"]?.LogsChannelID,w=B?getLogChannel(a.guild,B):null;return w&&(C=l.aNTcQ(moment).tz(config.Timezone),p=(new EmbedBuilder).setColor(config["EmbedC"+s(520)]||s(550)+"0")[s(525)+"le"](l.OmlUm)[s(500)+"cription"]([s(556)+s(465)+a[s(573)].id+">",s(569)+s(478)+" `"+r+"`",s(493)+"nel:** <#"+a.channel.id+">",s(482)+s(530)+C[s(514)](l[s(553)])].join("\n"))[s(531)+s(502)](a[s(573)][s(563)+s(581)+s(546)]())[s(486)+"ter"]({text:a.guild[s(475)],iconURL:a.guild[s(468)+"L"]()})["setTim"+s(519)](),await w.send({embeds:[p]})),!0}catch(e){if(l[s(503)](s(549),"rChDV"))return o;console.error("Error "+s(561)+s(583)+s(529)+"ed word:",e)}}}}}}return o}function replacePlaceholders(e,t,n={},r=null){var i=P,a={NuoAS:function(e,t){return e!==t},zUURT:i(467),MdlIY:i(552)+i(484)};if(!r){if(a.NuoAS(a.zUURT,"CywTE"))return t;r=moment().tz(config[i(461)+"ne"])}let o=e[i(511)+"e"](/{user}/g,"<@"+t.author.id+">")[i(511)+"e"](/{userName}/g,t.author[i(539)+"me"]).replace(/{userTag}/g,t.author[i(547)]).replace(/{userId}/g,t[i(573)].id)[i(511)+"e"](/{channel}/g,"<#"+t[i(577)+"l"].id+">")[i(511)+"e"](/{shorttime}/g,r[i(514)]("HH:mm"))[i(511)+"e"](/{longtime}/g,r.format(a.MdlIY))[i(511)+"e"](/{guildName}/g,t.guild[i(475)]);return Object[i(582)+"s"](n)[i(479)+"h"](([e,t])=>{o=o.replace(new RegExp("{"+e+"}","g"),t)}),o}function hasPermissionOrRole(e,t=[],n=[]){let r=P;return!!e&&(!(!{DcaaT:function(e,t){return t<e}}[r(536)](t[r(522)],0)||!e[r(512)+"sions"][r(564)](t))||0<n.length&&e.roles[r(551)].some(e=>n[r(480)+"es"](e.id)))}function parseDuration(e){var t=P,n={nGWPU:function(e,t){return e*t},ViuuP:function(e,t){return e*t}};if(!e)return 0;e=e[t(497)](/(\d+)([smhd])/);if(!e)return 0;var r=parseInt(e[1]);switch(e[2]){case"s":return 1e3*r;case"m":return n[t(574)](60*r,1e3);case"h":return 60*n[t(474)](r,60)*1e3;case"d":return 24*r*60*60*1e3;default:return 0}}function humanReadableDuration(e){var t=P,n={UIYFj:function(e,t){return e/t},KrSrP:function(e,t){return e/t},RwZut:function(e,t){return e/t},ArhVN:function(e,t){return t<e}},e=Math[t(555)](n[t(540)](e,1e3)),r=Math[t(555)](n.KrSrP(e,60)),i=Math[t(555)](r/60),a=Math.floor(n.RwZut(i,24));return 0<a?a+"d":0<i?i+"h":n[t(481)](r,0)?r+"m":e+"s"}function getTimeoutExpiryTimestamp(e){var t=P,e=new Date({lKtwm:function(e,t){return e+t}}[t(535)](Date.now(),e));return"<t:"+Math[t(555)](e.getTime()/1e3)+":R>"}function createLogEmbed(e,t,n,r,i=[],a=""){let o=P,s=(new EmbedBuilder).setTitle(n)["setDes"+o(534)+"on"](r).setColor(t)[o(488)+o(519)]();return 0<i[o(522)]&&i[o(479)+"h"](e=>{var t=o;s.addFields({name:e[t(475)],value:e.value,inline:e.inline||!1})}),a&&s.setFooter({text:a}),s}function getLogChannel(e,t){var n,r=P,i={msrnp:function(e,t){return e===t}};if(t)for(n of Array.isArray(t)?t:[t])if(n&&!i[r(509)](n,"")&&n!==r(543)+r(548)){var a=e.channels[r(551)].get(n);if(a)return a}return null}function sendLogMessage(e,t,n){var r=P,e={nBPUV:function(e,t,n){return e(t,n)}}[r(469)](getLogChannel,e,t);e&&e[r(462)]({embeds:[n]})[r(489)](console[r(504)])}async function sendDirectMessage(t,n,r){var i=P,a={PVaMG:"Failed"+i(476)+"nd DM:"};try{let e=n;for(var[o,s]of Object.entries(r))e=e.replace("{"+o+"}",s);await t.send(e)}catch(e){50007!==e.code&&console.error(a[i(490)],e)}}module.exports={convertPatternToRegex:convertPatternToRegex,checkBlacklistWords:checkBlacklistWords,clearBlacklistCache:clearBlacklistCache,replacePlaceholders:replacePlaceholders,hasPermissionOrRole:hasPermissionOrRole,parseDuration:parseDuration,humanReadableDuration:humanReadableDuration,getTimeoutExpiryTimestamp:getTimeoutExpiryTimestamp,createLogEmbed:createLogEmbed,getLogChannel:getLogChannel,sendLogMessage:sendLogMessage,sendDirectMessage:sendDirectMessage};