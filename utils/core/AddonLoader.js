let y=b;function a(){let e=["Eurzteq","DxrPBhm","nNPcwuDsrq","Aw5NigfK","svb4t2m","mtaWodu3DNvmA0TV","y29TBwfU","AgfZrgfZ","zg9U","BMv3","z2v0","yxjKsw5M","ufDqz1u","A3vJqvu","C2v0","CIb1BMXV","CMvZDwX0","DhLWzq","ChjPB3jP","CIbYDw5U","zxnszwn1","C2v0q29U","BM90igzV","yMXLigXL","y2fJAgu","DefKzg9U","Bg9HzeXL","Dw5K","vMTvug8","z2v0qxbP","v3HkD1O","zw1PDefK","A0vgBe0","yxbPuM91","BgvUz3rO","BMn0Aw9U","u3bTt0u","lI9HzgrV","zg9UrxzL","ntuXmJHlyMTQt3C","Dw5YzwDP","zM9YrwfJ","ChvZAa","q2fUBM90","AvvNv0y","w0fere9o","DgvT","ntaXmZG2nxnTrvPLBa","ms4WlJa","Bw9KDwXL","z2fJEufK","mNWXFdb8","AxnozxDg","zxjbzgrV","Bg9HzcbH","zxjqywDL","BLDbz3u","BMf2sxrL","ChrPB24","yxjK","lI9eyxnO","CM9Tia","zxjbCgLs","z2v0u3rH","weDgD1K","Aw5NigXL","zgzbyMO","zfDjDgG","DgvZ","nKn5wML6Dq","rwTTD2y","DMfSDwvZ","D1PlwMq","ywrKB25q","nZa0ntCZofvsEeDIAG","uwjNwNm","BvfgD1i","z2v0rgfZ","ve9qyxa","AgfZ","C2vW","lMPZB24","zgrVBG","AgXquK8","Dw5SB2fK","BNrnyw5H","ywDLCG","B21eAxjL","C3bSAxq","yMfZzw5H","zxjoyxzj","xsbgywLS","y1PHt3O","Bg9HzefK","yKnmCKu","CNvU","C2LVBNm","y2XPzw50","zufKzg9U","zgvSzxrL","C3rHDfn5","ufHfzMy","zcbMB3jT","AM9PBG","z2v0rMLS","B3jTyxrb","zg9UigzY","mZuXmZKXmLrbsK9ctq","AgjVyxjK","uM91DgvZ","Bg9HzgvK","Aw5JBhvK","zgLYBMfT","y29Uy2f0","lMPZ","t0Hbz0q","zMLSDgvY","qvP5r3C","z2fJEsbH","AxneAxjL","B20G","odmXnJaXoeP0ugz6DG","DMvYC2LV","zw5HyMXL","u3vVBuq","yxrOCW","yw5Hz2vY","BwvZC2fN","B3v0zq","yxv0Ag9Y","zxzLBNrZ","xsbfCNjV","zgrVBNm","y3rVCNK","t3jSExy","tfDKu0u","y29UzMLN","zw50CMLL","zw5KC1DP","qwrKB25Z","EsbSB2fK","Bg9Hze5L","zNjVBq","z21trxC","qwrKB24G","zxjYB3i","zxHWB3j0","BgvNywn5","yKHPqLO","zs9KAxnH","mta1ntiZv1nbAgjO","CgfNzxm","txj5sLm","zxzLBNrn","CNnPDMvS","CIbSB2fK","yxjKtwfU","Cgf0Aa","CMvHzgrP","zgfZAgjV","yxjKqxbW","mJKWquz5vwXK","y21KxW","CMvNAxn0","qwrKB24","ywrKB246","u3LUyW","zgvZy3jP","mJfID0vWufy","C2v0Dxbf","ywrKB24G"];return(a=function(){return e})()}(()=>{for(var e=b,r=a();;)try{if(601850==-parseInt(e(206))*(-parseInt(e(203))/2)+parseInt(e(198))/3*(parseInt(e(240))/4)+parseInt(e(248))/5+-parseInt(e(270))/6*(parseInt(e(275))/7)+-parseInt(e(308))/8+parseInt(e(322))/9+-parseInt(e(191))/10*(parseInt(e(180))/11))break;r.push(r.shift())}catch(e){r.push(r.shift())}})();let fs=require("fs"),path=require(y(187)),AddonEventManager=require("./AddonEventManager"),DashboardAddonManager=require(y(261)+"boardAddonManager");function b(s,e){let o=a();return(b=function(e,r){e-=152;let t=o[e];void 0===b.kZqTSz&&(b.VWLRZk=function(a){let s="",t="";for(let e=0,r,t,n=0;t=a.charAt(n++);~t&&(r=e%4?64*r+t:t,e++%4)&&(s+=String.fromCharCode(255&r>>(-2*e&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(let e=0,r=s.length;e<r;e++)t+="%"+("00"+s.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)},s=arguments,b.kZqTSz=!0);var e=e+o[0],n=s[e];return n?t=n:(t=b.VWLRZk(t),s[e]=t),t})(s,e)}class AddonLoader{constructor(){var e=y;this[e(183)+"anager"]=new AddonEventManager,this.dashboardManager=new DashboardAddonManager,this["loaded"+e(169)]=new Map,this.addonPaths=new Map}[y(278)+y(309)+"Manager"](){return this[y(189)+"ardManager"]}["setContext"](e,r,t){var n=y;this.eventManager[n(222)+"text"](e,r,t)}[y(305)+"esRecursively"](a){let s=y,o={TQUKw:function(e,r){return e!==r},LbjxP:function(e,r){return e===r},DPNKL:"OHAgD"},d=[];return fs[s(188)+"rSync"](a)[s(242)+"h"](e=>{var r=s,t=path[r(304)](a,e),n=fs.statSync(t);if(n&&n.isDirectory()){if(o.TQUKw("MVlQm","MVlQm"))return e[r(175)](r(246)+"] Error unloading "+r(200)+t+":",n),{success:!1,error:j.message};d=d.concat(this[r(305)+r(221)+"rsively"](t))}else if(e.endsWith(".js")){if(!o.LbjxP(r(316),o.DPNKL))return e.error("[ADDON"+r(292)+"ed to "+r(255)+"ddon f"+r(262)+t+":",n),{success:!1,error:j.message};d.push(t)}}),d}async[y(294)+"donsFr"+y(288)+y(163)](t=y(238)+"ns"){let n=y,a={GAZRK:n(192),tLOpT:function(e,r){return e+r},Ekmwf:function(e,r){return e+r},MryJS:"schemas",Vpqyo:"config.yml",PWPgU:n(166)+n(315),VkUPo:function(e,r){return e===r},AZyGw:"JOYzL"};if(fs["exists"+n(196)](t)){var s;let e=0,r=0;for(s of this[n(305)+"esRecursively"](t))try{if(!(s.includes(a.GAZRK)||s[n(312)+"es"](path[n(281)]+(n(207)+"ds")+path[n(281)])||s.includes(path.sep+"models"+path[n(281)])||s.includes(a.tLOpT(a.Ekmwf(path.sep,"schema"),path[n(281)]))||s.includes(path[n(281)]+a[n(182)]+path.sep)||s[n(312)+"es"](a[n(271)](path.sep+"data",path.sep))||s.includes(path[n(281)]+n(202)+path.sep)||s[n(168)+"th"](a.Vpqyo)||s.endsWith(n(282)))){if(s[n(312)+"es"](path[n(281)]+("dashbo"+n(260))+path.sep)){let e=s[n(289)](a.tLOpT(path[n(281)]+(n(189)+n(260)),path[n(281)]))[1]||"";if(!e.endsWith(a[n(213)])){if("yDYLD"===n(201))continue;return a[n(172)](this[n(311)+n(169)][n(167)+"s"]()).map(([e,r])=>({name:e,...r[n(166)],path:r.path,loadedAt:r[n(311)+"At"],type:r.type}))}}var o=await this["loadAd"+n(209)](s);o.success?e++:a[n(229)]("JOYzL",a[n(318)])?r++:(r.error("[ADDON] Erro"+n(185)+n(204)+n(307)+n(321)+s+":",o),j++)}}catch(e){console.error("[ADDON] Error load"+n(204)+"don from "+s+":",e),r++}return global["dashbo"+n(190)]&&0<this[n(189)+n(186)+n(287)][n(230)+n(310)]().length&&this.dashboardManager[n(199)+"xpressRoutes"](global[n(189)+"ardApp"],global[n(189)+"ardAuth"]),{loadedCount:e,errorCount:r}}}async["loadAddon"](t){let d=y,i={oFCSv:d(315),dWIth:function(e,r){return e!==r},mQFwR:d(245)};try{let e=path.resolve(t),r=t.match(/\/addons\/([^/]+)/)?t.match(/\/addons\/([^/]+)/)[1]:path[d(290)+"me"](t,d(315));delete require[d(225)][e];var n=require(e);if(this[d(253)+"ormatA"+d(283)](n))return await this[d(171)+"wFormatAddon"](n,r,e);if(i[d(268)](d(245),i[d(277)])){let a=[],s=h[d(188)+"rSync"](a);return s[d(242)+"h"](e=>{var r=d,t=a.join(s,e),n=o[r(301)+"nc"](t);n&&n[r(320)+r(163)]()?a=a[r(314)](this["getFilesRecu"+r(184)+"y"](t)):e.endsWith(i.oFCSv)&&a[r(243)](t)}),a}return await this["loadLe"+d(251)+"don"](n,r,e)}catch(r){if("maujJ"!==d(165))return console[d(175)](d(246)+"] Failed to "+d(255)+"ddon from "+t+":",r),{success:!1,error:r.message};this[d(189)+d(186)+d(287)]["registerNavI"+d(247)](e,f)}}["isNewF"+y(306)+y(283)](e){return e&&"object"==typeof e&&e.name&&(e.events||e.run)}async[y(171)+"wForma"+y(226)](e,r,t){var n=y,a={oIWsR:function(e,r){return e===r},dfAbj:"EoJRY",BWYDT:"bHiBZ",wTABG:"new"},s=e.name||r,o=(this[n(311)+"Addons"].has(s)&&await this[n(285)+n(194)](s),{name:s,version:e[n(152)+"n"]||"1.0.0",description:e[n(197)+n(259)]||"",events:e[n(160)]||{},permissions:e["permis"+n(297)]||[],priority:e[n(219)+"ty"]||0,dependencies:e.dependencies||[],author:e[n(159)]||"Unknown",enabled:!0,hasDashboard:!1});if(this[n(183)+"anager"][n(193)+n(254)+"n"](s,o),e.run&&"function"==typeof e[n(296)])try{await e[n(296)](this.eventManager.context.client,this[n(183)+"anager"])}catch(e){console[n(175)]("[ADDON] Error executing run fu"+n(236)+" for "+s+":",e)}var r=path[n(313)+"e"](t),d=await this["dashboardMan"+n(287)][n(294)+"donDas"+n(309)](s,r);if(d.success&&(o[n(208)+n(309)]=!0,o[n(189)+n(212)+"o"]=d.results),e[n(189)+"ard"]){if(e[n(189)+"ard"].pages){if("UoAjs"===n(276))return s[n(175)]("[ADDON"+n(161)+n(220)+n(266)+n(319)+"ddon "+o+":",r),{success:!1,error:d[n(157)+"e"]};for(var i of e[n(189)+"ard"][n(181)])this[n(189)+"ardMan"+n(287)]["regist"+n(256)](s,i)}if(e.dashboard[n(258)+"ms"])for(var u of e.dashboard.navItems)a.oIWsR(a[n(267)],a[n(267)])?this["dashbo"+n(186)+"ager"][n(193)+n(291)+"tem"](s,u):(a.hasDashboard=!0,s.dashboardInfo=o[n(217)+"s"]);if(e["dashbo"+n(260)][n(234)+"tes"])for(var c of e["dashbo"+n(260)].apiRoutes)n(178)!==a.BWYDT?t[n(243)](a):this[n(189)+"ardManager"][n(193)+"erApiR"+n(158)](s,c);o["hasDas"+n(309)]=!0}return this[n(311)+n(169)].set(s,{module:e,config:o,path:t,loadedAt:new Date,type:n(210)}),this[n(274)+n(155)][n(215)](t,s),await this.eventManager[n(232)+"donEvent"](n(195)+n(311),{name:s,config:o,path:t}),{success:!0,name:s,type:a.wTABG}}async[y(227)+y(251)+"don"](r,e,t){var n=y,a={gmSEw:function(e,r){return e===r},nWAgu:"function",cZaOz:n(252)+"3|4",SpmOE:n(249),WxJwZ:n(177),HnYkt:function(e,r){return e!==r},HQivx:"JyYrQ",GFkzU:"Invali"+n(303)+"at"},s=n(177)+"_"+e;if(this.loadedAddons[n(280)](s))return{success:!1,error:"Alread"+n(170)+"ed"};if(!r.run||!a[n(173)](typeof r.run,a[n(257)]))return a.HnYkt(n(154),a.HQivx)?{success:!1,error:a.GFkzU}:this.eventManager;try{var o=a[n(293)][n(289)]("|");let e=0;for(;;){switch(o[e++]){case"0":this["addonP"+n(155)].set(t,s);continue;case"1":this.loadedAddons.set(s,{module:r,config:{name:s,version:a[n(237)],description:"Legacy addon",type:n(177)},path:t,loadedAt:new Date,type:a[n(231)]});continue;case"2":await r.run(this.eventManager.context[n(298)]);continue;case"3":await this[n(183)+n(156)][n(232)+n(239)+"nt"](n(195)+"loaded",{name:s,path:t,type:"legacy"});continue;case"4":return{success:!0,name:s,type:n(177)}}break}}catch(e){return console.error(n(246)+n(161)+"r running legacy addon "+s+":",e),{success:!1,error:e.message}}}async["unloadAddon"](r){var t=y,n={wZKZd:"Addon not loaded",JqQlN:t(279),ODzmF:"7|6|4|5|2|1|3|0",kEFlM:"function"};if(!this["loaded"+t(169)][t(280)](r))return{success:!1,error:n[t(273)]};var a=this["loaded"+t(169)][t(211)](r);try{if("wXgjW"!==n.JqQlN){var s=n.ODzmF.split("|");let e=0;for(;;){switch(s[e++]){case"0":return{success:!0};case"1":this[t(274)+t(155)][t(300)](a[t(187)]);continue;case"2":this[t(311)+"Addons"].delete(r);continue;case"3":await this["eventM"+t(156)]["emitAd"+t(239)+"nt"]("addon:"+t(285)+"ed",{name:r,path:a[t(187)],type:a[t(218)]});continue;case"4":a.module[t(285)]&&typeof a[t(250)][t(285)]===n[t(233)]&&await a.module[t(285)]();continue;case"5":delete require.cache[a[t(187)]];continue;case"6":this["dashboardMan"+t(287)][t(241)+"sterAddon"](r);continue;case"7":"new"===a[t(218)]&&this.eventManager.unregisterAddon(r);continue}break}}}catch(e){return console.error("[ADDON] Erro"+t(216)+"ading "+t(200)+r+":",e),{success:!1,error:e[t(157)+"e"]}}}async["reloadAddon"](e){var r=y,t=this["loaded"+r(169)][r(211)](e);return t?(t=t.path,await this.unloadAddon(e),this["loadAd"+r(209)](t)):{success:!1,error:r(174)+"not loaded"}}["getAddon"](e){var r=y;return this["loaded"+r(169)][r(211)](e)||null}["getAll"+y(169)](){let t=y;return Array[t(172)](this["loaded"+t(169)][t(167)+"s"]()).map(([e,r])=>({name:e,...r[t(166)],path:r.path,loadedAt:r.loadedAt,type:r[t(218)]}))}["getEve"+y(286)+"ger"](){return this.eventManager}async[y(153)+"Addon"](e){var r=y,t={kucAU:"Addon not found",fYJgg:"new",Orlyv:"Cannot enabl"+r(179)+r(224)+"gacy a"+r(162)},n=this.loadedAddons.get(e);return n?n.type===t.fYJgg?{success:this[r(183)+"anager"]["enable"+r(194)](e)}:{success:!1,error:t[r(164)]}:{success:!1,error:t[r(214)]}}async["disabl"+y(299)](e){var r=y,t={bCLrE:r(174)+r(223)+r(228),XGFwY:"new",IPxOc:function(e,r){return e===r},PXEff:r(244)+" enabl"+r(179)+"ble le"+r(319)+r(162)},n=this["loaded"+r(169)].get(e);if(!n)return{success:!1,error:t[r(295)]};if(n.type===t[r(265)]){if(!t[r(205)]("MpILx",r(284)))return{success:this[r(183)+"anager"]["disabl"+r(299)](e)};for(var a of a[r(189)+r(260)]["apiRou"+r(269)])this.dashboardManager[r(193)+r(263)+"oute"](i,a)}return{success:!1,error:t[r(302)]}}[y(264)+"ts"](){let r=y,e=this.eventManager[r(264)+"ts"](),t=Array[r(172)](this[r(311)+r(169)][r(272)]()).filter(e=>e.type===r(177)).length,n=Array.from(this["loaded"+r(169)][r(272)]())[r(317)](e=>e.type===r(210))[r(235)];return{...e,legacyAddons:t,newAddons:n,totalLoadedAddons:this[r(311)+"Addons"].size}}}module[y(176)+"s"]=AddonLoader;