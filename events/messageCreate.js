let I=b,{getConfig,getLang}=((()=>{for(var e=b,t=a();;)try{if(747547==-parseInt(e(334))*(parseInt(e(264))/2)+parseInt(e(364))/3+parseInt(e(350))/4+-parseInt(e(236))/5*(-parseInt(e(205))/6)+-parseInt(e(268))/7+-parseInt(e(336))/8*(parseInt(e(242))/9)+-parseInt(e(187))/10*(-parseInt(e(214))/11))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(),require(I(221)+"ls/core/configLoader")),handleXP=require(I(347)+"ls/han"+I(340)).handleXP,handleMessageCount=require("./Levels/handleMes"+I(289)+I(229)),suggestionActions=require(I(339)+"estions/sugg"+I(292)+"Actions"),isBlacklisted=require("../uti"+I(226)+"gestio"+I(365)+I(216)).isBlacklisted,Ticket=require("../mod"+I(278)+"ckets"),autoHandleAlertCancel=require(I(326)+"mands/Utilit"+I(333)+I(230)+I(232)).autoHandleAlertCancel,handleAutoClaim=require(I(221)+"ls/tickets/ticketC"+I(181)+"g").handleAutoClaim,notifyWatchers=require(I(221)+I(379)+"kets/ticketW"+I(313)+"s").notifyWatchers,sharp=require("sharp"),axios=require("axios"),BLACKLIST_CACHE_DURATION=3e5,MAX_TICKET_MESSAGES=500,checkBlacklistWords=require(I(221)+"ls/handlers/messag"+I(223)).checkBlacklistWords,processAutoResponses=require("../utils/han"+I(182)+"autoResponse"+I(175)+"r").processAutoResponses,{processCustomCommands,handleButtonInteraction}=require("../utils/han"+I(182)+"custom"+I(361)+"dHandler"),{checkAntiMassMention,checkAntiSpam}=require("../uti"+I(377)+"urity/antiSp"+I(273)+"ler"),checkAutoReact=require(I(221)+I(234)+I(182)+I(269)+"actHan"+I(255)).checkAutoReact,{addMessageToGuildBatch,handleVerificationSettings}=require(I(221)+"ls/gui"+I(281)+I(363)+I(266)+"er"),config=getConfig(),lang=getLang();function b(i,e){let r=a();return(b=function(e,t){e-=175;let n=r[e];void 0===b.YQXCnx&&(b.TAWfei=function(i){let r="",n="";for(let e=0,t,n,a=0;n=i.charAt(a++);~n&&(t=e%4?64*t+n:n,e++%4)&&(r+=String.fromCharCode(255&t>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(let e=0,t=r.length;e<t;e++)n+="%"+("00"+r.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(n)},i=arguments,b.YQXCnx=!0);var e=e+r[0],a=i[e];return a?n=a:(n=b.TAWfei(n),i[e]=n),n})(i,e)}async function checkStaffMentionStatus(r,e,t){let s=I,o={aNftF:s(220)+"e",ZzqtD:"idle",fseIW:s(372)+"ff} is"+s(239)+"ntly **away** and "+s(331)+"ke longer to respo"+s(291),raKBr:function(e,t){return e(t)},RobMu:s(328)+"0",JbkEB:function(e,t){return e===t},mOHoC:function(e,t){return t<=e},IxPYa:function(e,t){return e!==t},vCjFx:s(258),AwzlT:"Error "+s(355)+"ng staff men"+s(370)+s(280)};try{if(r[s(293)+"ns"][s(198)].size){var n=t[s(283)+s(305)][e.ticketType];if(n){let a=n[s(297)+s(317)]||[];if(a[s(225)]){let n=t.TicketSettings?.StaffMentionAlert;if(n?.[s(203)+"d"])for(let[e,t]of r.mentions[s(198)])if(!t.bot&&e!==r.author.id){var c=await r.guild[s(272)+"s"][s(378)](e).catch(()=>null);if(c)if(c[s(321)].cache[s(202)](e=>a[s(257)+"es"](e.id))){var l=c.presence?.[s(262)]||o.aNftF;if((n[s(298)+s(376)+"s"]||[s(220)+"e",o.ZzqtD,"dnd"]).includes(l)){var g={offline:n.Messages?.[s(358)+"e"]||s(372)+s(252)+s(239)+s(218)+"*offline** and may"+s(327)+s(190)+s(367)+s(322)+s(274)+"ay.",idle:n[s(366)+"es"]?.[s(314)]||o[s(354)],dnd:n.Messages?.DND||"‚ö†Ô∏è {staff} has **Do"+s(194)+s(233)+"** ena"+s(295)+"nd may not r"+s(177)+s(371)+"iately."},u=(g[l]||g.offline)[s(200)+"e"](s(362)+"}","<@"+e+">")[s(200)+"e"]("{user}",r.author.toString()),f=o[s(189)](require,"discor"+s(284)).EmbedBuilder,h=(new f).setColor(n["EmbedC"+s(342)]||o[s(329)])[s(330)+s(235)+"on"](u);if(n[s(267)+s(319)+"ives"]&&0<a.length){var d,m,w=[];for(d of a){var v=r[s(222)][s(321)][s(301)][s(217)](d);if(v){for(var[L,B]of v[s(272)+"s"])if(L!==e){var y=B.presence;if(("online"===y?.[s(262)]||o.JbkEB(y?.[s(262)],s(212)))&&(w[s(357)](B),3<=w[s(225)]))break}if(o[s(323)](w[s(225)],3))break}}0<w.length&&(m=w[s(312)](e=>"<@"+e.id+">").join(", "),h[s(251)+"lds"]({name:n[s(352)+"atives"+s(219)]||"üü¢ Available "+s(207),value:m}))}await r.channel.send({embeds:[h]})[s(344)](()=>{})}}}}}}}catch(e){o[s(215)](o[s(206)],"iCyFA")?10008!==o.code&&i[s(183)]("Error "+s(276)+"ng message:",j):console.error(o[s(201)],e)}}let MAX_IMAGE_SIZE=2097152,MAX_ATTACHMENTS_PER_MESSAGE=5;async function handleTicketMessageLogging(o){let c=I,g={ClaMK:c(343),VsPYK:c(368),avira:"_id messageCount"};try{const u=await Ticket.findOne({channelId:o.channel.id,status:c(197)}).select(g[c(231)]).lean();if(!u)return;let e=Array[c(303)](o[c(237)+c(310)].values()).slice(0,MAX_ATTACHMENTS_PER_MESSAGE),t=e[c(312)](async a=>{var i=c,r={url:a[i(288)],proxyURL:a[i(380)+"RL"],contentType:a.contentType,name:a.name,id:a.id,timestamp:o[i(209)+i(208)]};if(a[i(184)+i(193)]?.startsWith(g[i(373)])&&a.size<MAX_IMAGE_SIZE)if(i(196)!==i(196))u=e[i(191)];else try{if(i(368)===g[i(224)]){let e=await axios[i(217)](a.url,{responseType:"arraybuffer",timeout:5e3,maxContentLength:MAX_IMAGE_SIZE}),t=Buffer[i(303)](e.data),n=await sharp(t).jpeg({quality:50,progressive:!0})[i(345)](1280,720,{fit:i(246),withoutEnlargement:!0})[i(296)+"er"]();r.binaryData=n,r[i(375)]=n.length,r.compressed=!0}else s(a,r,"message",{authorId:l[i(185)].id,content:m.content,attachments:n["attach"+i(310)][i(375)]})}catch(e){}return r}),a=await Promise[c(254)](t),s={author:o.author[c(244)],authorId:o.author.id,content:o.content,timestamp:o.createdAt,attachments:a};await Ticket.updateOne({channelId:o.channel.id,status:"open"},{$push:{messages:s,attachments:{$each:a}},$inc:{messageCount:1}})}catch(e){console.error("Error "+c(325)+c(238)+c(271)+c(186),e)}}function a(){let e=["Aw5ZAwrL","zMLUze9U","DwvZDgLV","rgXfwLy","BgLtB1G","ywrKrMLL","zMz9igLZ","zu1LC3nH","ywXS","zgXLCG","ywDL","Aw5JBhvK","Aun5rKe","t3jPz2LU","zMyGBwvU","t25L","C3rHDhvZ","vhLWzq","mLrfDKvbBq","Aw4Gy29T","AeHHBMrS","u2HVD0fS","otaXmJy2ofDgre5hqG","yxv0B1jL","DgLVBNm","zxqGBwvZ","BwvTyMvY","yw1iyw5K","z2H0igf3","yMXVy2Tc","zgvSzxrP","tLDXuMO","zwXZl3rP","rxjYB3iG","Dgf0Dxm6","BgqVz3vP","u3vNz2vZ","vgLJA2v0","zc5QCW","rxjYB3i","tf9jra","C3rPB25j","DxjS","C2fNzunV","q0HbtK5f","BMqU","zxn0Aw9U","BwvUDgLV","qwXSB3Dd","yMXLzcbH","Dg9cDwzM","u3vWCg9Y","qwXLCNrt","z2vuAw1L","AgfUBMvS","y2fJAgu","DgLVBLnL","zNjVBq","Aw5NoG","vhLWzxm","BwvKignS","DgXLza","tKnxDhG","DwPdvuW","BwvUDhm","Axn0twvZ","BwfW","yxrJAgvY","swrSzq","tNbMyMe","rgvSzxrL","DfjVBgu","CM9JzxnZ","DgvYBMf0","y29Kzq","CM9Szxm","ywDLihjP","Bu9iB0m","y3jLyxrP","Bg9Nz2LU","lI4Vy29T","ig5VDcbZ","i0zgqtuW","uM9Itxu","C2v0rgvZ","Bwf5ihrH","qwXSB3DL","Es9uAwnR","mtm5ote3rLfqDvfz","B3v0","mteYAwr1sgDV","Axn0v29Y","zhnqCMvM","lI9tDwDN","zgXLwfa","A2v0vhLW","B2XVCG","Aw1Hz2uV","y2f0y2G","CMvZAxPL","ywXnzxnZ","lI9mzxzL","BMCGC3vN","Aw4GDgLJ","mJeYmZKWnhvWwK9Jtq","q2HHBM5L","qwX0zxjU","sKP0yvm","zNnLsvC","y2HLy2TP","A2v0igHH","ChvZAa","t2zMBgLU","ywXLCNrn","zgvSzxrL","q29TBwfU","E3n0ywzM","BgrcyxrJ","mJG4mty4m2Dns0v0Ea","BNmVyMXH","twvZC2fN","CIbTzxnZ","vNDiv2q","u2v0DgLU","DgLVBIbZ","igLTBwvK","4PQG77IpihTZDge","q2XHtuS","y2HHBM5L","C2L6zq","Dgf0DxnL","BhmVC2vJ","zMv0y2G","BhmVDgLJ","ChjVEhLv","Bfn1z2DL","sgfUzgXL","zLrbAge","zxnWB25K","BeLe","BgvoBe4","rMfPBhvY","BgfPBwLU","zgXLCNmV","zxjYB3i","y29UDgvU","yxv0Ag9Y","C2fNztO","mtb5rerwyNm","zfjVBgvZ","CMflqNi","zwuGEw91","DMfSDwu","C2vUza","Dfr5Cgu","ie5VDcbe","BwfUzcbW","yuvNBfa","B3bLBG","DxnLCNm","DhrPBMDZ","CMvWBgfJ","qxD6Bfq","C29Tzq","rw5HyMXL","DxbKyxrL","mZm2t1nNquLi","DKnQrNG","u3rHzMy","zef0","y3jLyxrL","y2XHAw1L","C2vSzwn0","AwrSzq","AxnbCNjH","mtmWotuZnZLfvfv5tfq","sxHqwwe","y2TSAxn0","z2v0","BNrSEsaQ","vgL0Bgu","B2zMBgLU","lI4VDxrP","z3vPBgq","zvv0AwXZ","vNnqwuS","BgvUz3rO","BhmVC3vN","DxnLCKLK","D25pBe0","Dw50","zxrZl3rP","yxzPCMe","y2TLDhm","Axn0DxjI","BhmVAgfU","y3jPChrP","mZC5mJbosK94u3m","yxr0ywnO","zYb0AwnR","ign1CNjL","zxnZywDL","C2fNzuLK","ntK4otC3Dg9eC1fr","BMvSswqG","DgfN","z2vZ"];return(a=function(){return e})()}module.exports=async(a,i)=>{let r=I,s={ujCUL:function(e,t){return e!==t},lUaZD:"NCWtx",maVPo:"Error "+r(276)+"ng message:",leNlN:function(e,t){return e===t},JJtaS:function(e,t,n,a,i){return e(t,n,a,i)},liSoX:function(e,t,n,a){return e(t,n,a)},sLIzT:function(e,t,n){return e(t,n)},Xxoug:function(e,t){return e(t)},FRHNk:function(e,t){return e(t)},Xepuc:function(e,t){return e(t)},mTrnT:function(e,t){return e(t)},wnOlM:"UPrhN",SVLiM:function(e,t){return e===t},dQacg:"DlEZV",OnENZ:r(277)};if(i[r(222)]&&i[r(272)]&&!i[r(185)].bot){let n=!1;try{if(config[r(283)+r(369)+"gs"]?.[r(203)+"d"]){let t=await Ticket[r(247)+"e"]({channelId:i.channel.id,status:"open"})[r(211)]("alertTime alertMes"+r(241)+" userId chan"+r(243)+"ticketId tic"+r(341)+"e clai"+r(306)+"aimedBy firstMessageId q"+r(248)+"ns").lean();if(t){t.alertTime&&t[r(359)+r(240)+"Id"]&&s.leNlN(t[r(227)],i[r(185)].id)&&await s[r(353)](autoHandleAlertCancel,t,i.author.id,i[r(374)+"l"].id,a),t[r(210)+"d"]||t[r(227)]===i.author.id||await handleAutoClaim(a,i,t),await s[r(250)](checkStaffMentionStatus,i,t,config),await handleTicketMessageLogging(i);var o=await Ticket[r(247)+"e"]({channelId:i[r(374)+"l"].id}).lean();o&&o.watchers&&0<o.watchers.length&&("fTAha"===r(176)?s.JJtaS(notifyWatchers,a,o,"message",{authorId:i[r(185)].id,content:i.content,attachments:i.attachments.size}):s.error(r(279)+"logging tick"+r(271)+r(186),n));let e=config[r(283)+r(305)][t["ticket"+r(263)]];t.claimed&&t.claimedBy===i[r(185)].id&&e?.["Suppor"+r(317)]&&await Ticket[r(204)+r(261)]({channelId:i.channel.id},{$set:{lastStaffResponse:new Date}})}}}catch(e){console.error(r(279)+r(349)+"ket handling:",e)}if(i.content.startsWith(config["Comman"+r(338)+"ix"]))try{await processCustomCommands(a,i)}catch(e){console[r(183)](r(279)+r(265)+"mand p"+r(318)+r(304),e)}if(n=await s.sLIzT(checkBlacklistWords,i,n),i.deletable){await handleMessageCount(i),await s.Xxoug(handleXP,i),await checkAutoReact(i);var[o]=await Promise["allSet"+r(307)]([s.FRHNk(checkAntiMassMention,i),s.Xepuc(checkAntiSpam,i),s.mTrnT(addMessageToGuildBatch,i.guild.id),processAutoResponses(i)]),o=(s[r(179)](o[r(262)],"fulfilled")&&(s.ujCUL(s[r(228)],"RoXRw")?n=o[r(191)]:g(()=>k[r(360)]()[r(344)](l.error),j[r(282)+r(302)+"ttings"]["FailureMessa"+r(299)+"out"])),s.FRHNk(handleVerificationSettings,i),config["Sugges"+r(302)+r(199)][r(351)+r(381)+r(287)+"D"]||config[r(282)+r(302)+"ttings"]["Channe"+r(178)]),o=(Array[r(213)+"y"](o)?o:[o]).some(e=>e&&""!==e&&e!==r(290)+r(286)&&i[r(374)+"l"].id===e);if(o&&config[r(282)+"tionSettings"][r(294)+r(300)+"Sugges"+r(270)]){o=i.content;if(0===config.SuggestionSettings[r(332)+r(188)].length||config[r(282)+r(302)+"ttings"][r(332)+r(188)][r(202)](e=>i.member.roles[r(301)].has(e)))if(await isBlacklisted(i[r(185)].id,BLACKLIST_CACHE_DURATION)){let e=await i[r(374)+"l"][r(192)]({content:lang.Suggestion["Blackl"+r(311)+"sage"]});config["Sugges"+r(302)+r(199)][r(316)+r(180)+r(253)+r(245)]&&s.sLIzT(setTimeout,()=>e.delete()[r(344)](console.error),config[r(282)+r(302)+"ttings"]["Failur"+r(253)+r(299)+r(335)]),void(config[r(282)+r(302)+r(199)]["Delete"+r(259)+"alMess"+r(256)]&&(s.SVLiM(s.dQacg,r(249))?await i.delete()[r(344)](console[r(183)]):s[r(183)]("Error "+r(355)+"ng sta"+r(260)+r(370)+r(280),n)))}else{if(config[r(282)+"tionSettings"][r(275)+"lacklistWords"]){var e={content:o,member:i[r(272)],channel:i[r(374)+"l"],author:i[r(185)],deletable:!0};if(await s.sLIzT(checkBlacklistWords,e,!1)){let e=await i.channel.send({content:lang["Blackl"+r(337)+"ds"][r(366)+"e"][r(200)+"e"](/{user}/g,i.author.toString())});return config.SuggestionSettings[r(316)+"FailureMessages"]&&setTimeout(()=>e[r(360)]().catch(console.error),config[r(282)+r(302)+"ttings"][r(180)+r(253)+"geTimeout"]),void(config[r(282)+r(302)+r(199)][r(316)+r(259)+r(346)+r(256)]&&await i.delete().catch(console.error))}}try{if(await suggestionActions[r(209)+r(282)+"tion"](a,i,o),config[r(282)+"tionSettings"]["Delete"+r(259)+r(346)+r(256)])if(s.ujCUL(s.OnENZ,r(315)))try{await i.delete().catch(e=>{var t=r;s[t(309)](s.lUaZD,t(308))||10008!==e[t(320)]&&console[t(183)]("Error "+t(276)+"ng mes"+t(186),e)})}catch(e){10008!==e[r(320)]&&console[r(183)](r(279)+r(276)+"ng message:",e)}else s[r(183)](r(279)+"in tic"+r(356)+"ndling:",n)}catch(e){console[r(183)](r(279)+r(324)+r(348)+"gestion:",e);let t=await i.channel.send({content:i[r(185)]+", "+lang.Suggestion[r(285)]});setTimeout(()=>t[r(360)]().catch(e=>{var t=r;s[t(309)](e[t(320)],10008)&&console.error("Error deleting error mes"+t(186),e)}),5e3)}}else{let e=await i[r(374)+"l"][r(192)]({content:lang.NoPermsMessage});config[r(282)+r(302)+"ttings"].DeleteFailureMessages&&setTimeout(()=>e[r(360)]()[r(344)](console[r(183)]),config["SuggestionSe"+r(199)][r(180)+"eMessa"+r(299)+r(335)]),void(config["Sugges"+r(302)+"ttings"][r(316)+r(259)+"alMess"+r(256)]&&await i.delete().catch(console[r(183)]))}}}}};