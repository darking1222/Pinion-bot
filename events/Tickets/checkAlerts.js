let U=b;function a(){let e=["s2jXuxu","y2fJAgu","nJGWnJqZq2XjsMrd","z3vPBgq","tMfTzq","Cg1wzgK","ywXLCNru","B2fKzxiU","CY90AwnR","mJi3mZC1ngHxwvPusG","ihrPy2TL","zMv0y2G","q2XHAw1P","sxzcqwm","BwvLt1e","wNL1zwq","tgvbvNm","DcbOyxmG","ignOyw5U","Dhm6","CMLUzYbH","ENHjD3q","vgLJA2v0","Aw4Gy2HL","rKzsy0W","u3vWCg9Y","BwfW","DgfN","BMnSywLT","zef0","ywXLCNrn","oMf1Dg9v","lI4VlI4V","qw55igf2","C29Tzq","Chv0","zIbTzw1I","BLLkuK4","Dg5Iu2i","vhLWzxm","ig5VDYbY","y3jLyxrL","l3rPy2TL","Dg9tDhjP","mJe5nZa0mgXpu293Dq","zMLSDgvY","y29Yzs9J","rwzKy2u","Dc5Zy2fU","zxHWB3j0","qxv0B1vU","CKnHC2u","rKTdEuG","swXduxe","y2TLDca","DxnLCM5H","zMLUza","DgfTCa","CKnZy3m","ywXLCNq","otG0mJe2ELDysKjT","Aw5NihbL","y2TLDeLK","twvZC2fN","zxj9","BwvZC2fN","B21Tyw5K","vhLWzq","DMfSDwvZ","zgLZy29Y","DgLJA2v0","C2L6zq","mtzyzKXTDfG","rw5HyMXL","vvPovwO","CM9TidXa","y3vbtwm","DwuGDg8G","zxiGy2fU","C2vUza","DxrVBwf0","zxjYB3i","B25Zigr1","DxrPBhmV","t1Hdrhq","rfjSqMW","zNjVBq","CM1PC3nP","mJK2nJe5nNHjEef3yq","mti4ntG5mu5hz3reBa","y2f0y2G","Cg9UC2uG","Cg9UC2u","C2vYswqG","yxv0Ag9Y","B3bLBG","mtvZt3LXAvq","Aw5JBhvK","C2vSzwn0","vufMr3e","DxnLCG","zMLUze9U","wfD1AuC","zufUzfvW","CM9Szxm","zgvSzxrL","yMvLBIbH","zKz4EwK","DhjPBq","DfjVBgu","EgzjtLa","zMLYC3rn","thDeDwK","q2HHBM5L","z2v0rxzL","uNrWquu","zxHLy3v0","4PQG77IpifrOAxm","qwXLCNq","C2uGzMLY","E2nSywLT","BwvTyMvY","Aw1LigfS","t25L","Aw1L","zc5QCW","zfrPBwvZ","vgXbwhq","Dg9WAwm","DxjLlMPZ","BM90igzV","xsbfCNjV","y2XHAw1L","C2fNzuLK","vw5JBgfP","CguGBgfZ","uMvZCg9U","zxrdBgfP","w0rfqLvh","x2LKihrP","DML0EsbM","y2HHBM5L","C2LUzYb0","ywzMuMvZ","sw5Hy3rP","s1Pbq00","B2fKzxi","q2HHDeLU","BgvUz3rO","vLDszvK","sgPADMK","Dw5KigLU","zej5","zxj9pI4G","Bw1HBMqG","DxbKyxrL","Bwf0y2G","CMvZzxr0","ywz0zxiG","ywrKB25m","y2XHAw0","zxrZignV","qxv0BYbH","Bw9KzwXZ","z2v0","ywXS","y2XHAw06","EgzrsuO","rxjYB3iG","y2TbDxrV","mZu3nZG4tMXVy0P3","zgf0zq"];return(a=function(){return e})()}(()=>{for(var e=b,t=a();;)try{if(825365==-parseInt(e(132))+-parseInt(e(213))/2+-parseInt(e(275))/3+parseInt(e(259))/4*(parseInt(e(139))/5)+parseInt(e(131))/6+parseInt(e(224))/7+parseInt(e(287))/8*(parseInt(e(217))/9))break;t.push(t.shift())}catch(e){t.push(t.shift())}})();let Ticket=require("../../"+U(206)+U(257)+"ts"),{getConfig,getLang,getCommands}=require(U(247)+U(298)+U(261)+"onfigL"+U(222)+"js"),handleTicketClose=require("../../"+U(298)+"ticket"+U(223)+"etClos"+U(172)).handleTicketClose,{resetTicketPermissions,updateClaimButton,updateTicketEmbed}=require(U(247)+"utils/tickets/tick"+U(180)+"ming.js"),{EmbedBuilder,ActionRowBuilder,ButtonBuilder,ButtonStyle,ApplicationCommandType,InteractionType}=require(U(284)+U(168)),config=getConfig(),client=require(U(247)+"index");async function triggerAlertCommand(r,i,n){let a=U,c={IvBAc:"aJTZJ",xfQIJ:function(e,t){return e!==t},cGEPi:"zYKhr",DRlBl:"meeOQ",FpKvB:"[DEBUG"+a(174)+"r triggering alert command:"};try{if(c[a(228)]!==a(142)){let e={client:r,guild:i.guild,channel:i,user:{id:r[a(143)].id,tag:r[a(143)][a(242)],username:r[a(143)].username},member:{...await i[a(218)][a(164)+"s"][a(226)](r.user.id),roles:{cache:{some:t=>config["Ticket"+a(254)][n.ticketType]["Suppor"+a(152)].some(e=>t({id:e})),map:t=>config[a(237)+a(254)][n["ticket"+a(282)]]["Suppor"+a(152)].map(e=>t({id:e}))}}},commandId:"tickets",commandName:"tickets",type:InteractionType.ApplicationCommand,commandType:ApplicationCommandType[a(190)+a(250)],options:{getSubcommand:()=>"alert",getSubcommandGroup:()=>null,getString:()=>a(205)+"lert: No res"+a(135),getUser:()=>null},reply:async e=>i.send(e),deferReply:async()=>{},editReply:async e=>null,followUp:async e=>i.send(e)},t=r["slashC"+a(281)+"s"].get("tickets");if(t)if(c[a(210)](a(155),c.cGEPi))await t[a(159)+"e"](e);else{let t={RtpAE:function(e,t){return e(t)}};k[a(161)]&&l.Alert[a(288)+"d"]&&s(()=>{var e=a;t[e(158)](v,w)},6e4),p(()=>{v(w)},6e4)}else console.error(a(181)+"] Tick"+a(204)+a(197)+a(173)+"und in slashCommands")}else n(c)}catch(e){c[a(300)]===a(229)?console[a(296)](c.FpKvB,e):c.error(a(211)+"auto-unclaiming ti"+a(269)+g[a(285)+"Id"]+":",h)}}function parseDuration(e){var t,r=U,i={cdmIZ:function(e,t){return e*t},kjBJe:function(e,t){return e*t},OXCDt:function(e,t){return e*t}};return(e=e&&(e=e[r(258)+"ng"]()[r(151)]())[r(199)](/^(\d+)\s*([smhd])$/i))?(t=parseInt(e[1]),e=e[2]["toLowe"+r(266)](),t*{s:1e3,m:i.cdmIZ(60,1e3),h:i.kjBJe(3600,1e3),d:i[r(299)](86400,1e3)}[e]):0}async function checkAutoUnclaim(r){let n=U,a={tnbSb:"Error "+n(200)+n(276)+n(130)+n(297)+n(235)+"uto-un"+n(209),MBvZP:n(230),AGRrN:n(252),fFxyi:function(e){return e()},YFdeH:n(138),VWReY:"_id ticketId"+n(233)+"elId userId claimedBy ticketTy"+n(178)+"tStaff"+n(179)+n(162)+"stMessageId create"+n(244),uAAqV:function(e,t){return e(t)},ShylM:n(148)+"d",KbqQu:function(e,t,r,i){return e(t,r,i)},rCscs:function(e,t,r,i,n){return e(t,r,i,n)},IlCQq:function(e,t){return e!==t},KCYwX:n(211)+n(238)+"ckAutoUnclaim:"};try{if(a.MBvZP!==a.AGRrN){const m=getConfig(),y=a[n(150)](getLang),g=new Date,h=await Ticket[n(271)]({status:a.YFdeH,claimed:!0,claimedBy:{$ne:null}}).limit(20).select(a[n(192)]).lean();for(let t of h)try{let e=m["Ticket"+n(254)][t[n(285)+n(282)]];if(e?.[n(227)+"ng"]?.[n(265)+n(203)]?.[n(288)+"d"]){var c=a.uAAqV(parseDuration,e[n(227)+"ng"].AutoUnclaim[n(187)+"veTime"]);if(c){var l=t["lastSt"+n(186)+"ponse"]||t.createdAt,s=g-new Date(l);if(!(s<c)){var u=await r[n(184)+"ls"].fetch(t[n(184)+"lId"])[n(133)](()=>null);if(u){var o=t[n(175)+n(195)],d=(await Ticket[n(144)+n(146)+n(214)]({ticketId:t[n(285)+"Id"],claimed:!0},{claimed:!1,claimedBy:null,lastStaffResponse:null},{new:!0}),await resetTicketPermissions(u,t,e).catch(e=>{var t=n;console.error(a[t(253)],e)}),await u.messages[n(226)](t[n(154)+"essageId"])[n(133)](()=>null));if(d&&await Promise[n(208)]([a[n(215)](updateClaimButton,d,e,null),a[n(273)](updateTicketEmbed,d,t,e,null)]).catch(()=>{}),e.Claiming.AutoUnclaim["Notify"+n(156)+"l"]){if(a[n(268)]("hKleM","hKleM"))return null;var f=(new EmbedBuilder).setColor("#FFA500").setDescription((y?.Tickets?.["AutoUn"+n(203)]?.[n(278)+"e"]||n(160)+n(225)+n(232)+n(149)+n(295)+"ically unclaimed d"+n(292)+"inacti"+n(183)+n(290)+n(163)+n(196)+n(248)+"ailable staf"+n(251)+n(293)+n(255)+"espond.").replace(n(163)+n(279),o));await u[n(294)]({embeds:[f]}).catch(()=>{})}global[n(202)+"oader"]&&global[n(202)+n(189)][n(157)+"ntManager"]().emitSafe("ticket"+n(246)+n(243)+"ed",{ticketId:t.ticketId,previousClaimer:o,guild:u[n(218)],channel:u})}else await Ticket["findOn"+n(146)+"date"]({ticketId:t[n(285)+"Id"]},{status:a.ShylM,deletedAt:new Date})}}}}catch(e){console.error("Error auto-u"+n(243)+"ing ticket "+t.ticketId+":",e)}}else g=h,i=j}catch(e){console[n(296)](a.KCYwX,e)}}async function checkAlerts(o){const d=U,f={abgbH:function(e){return e()},YmiJQ:function(e,t){return e(t)},pmVdi:"../../utils/core/perfMonitor",cuAMc:d(285)+"s.aler"+d(263),XWuiG:function(e,t){return e===t},LeAVs:d(239),iqZPl:function(e,t){return t<e},zxIwt:d(262),FKCyH:function(e,t){return e&&t},OcZyD:function(e,t){return t<=e},UZNUj:function(e,t,r,i){return e(t,r,i)},rjQtk:function(e,t,r,i,n){return e(t,r,i,n)},Khkvp:"No res"+d(134)+d(201)+d(274),xfINP:"xHDhT",TlAXt:"JmECh"};try{let s=f.abgbH(getConfig),u=new Date,e=f.YmiJQ(require,f[d(220)]).observeAsync,r=await e(f[d(291)],async()=>Ticket.find({status:d(138),$or:[{alertTime:{$lte:u}},{alertTime:null},{alertTime:{$exists:!1}}]}).limit(20)[d(141)](d(182)+d(277)+" channelId u"+d(136)+d(221)+d(165)+"ertMes"+d(176)+d(225)+"tType").lean());for(const A of r)try{var m=await o[d(184)+"ls"][d(226)](A[d(184)+"lId"])[d(133)](()=>null);if(m){const a=m[d(171)],c=a?.match(/Category:\s*([^|]+)/),l=c?c[1][d(151)]():null;let t=null;for(var[i,n]of Object.entries(s.TicketTypes)){if(f.XWuiG("HDxhd",d(188))){let t=u["Ticket"+d(254)][e["ticket"+d(282)]]["Suppor"+d(152)]||[];return t.map(e=>t({id:e}))}if(n[d(219)]===l){t=n,A[d(285)+"Type"]=i;try{if(f[d(231)]!==f[d(231)]){let t=r[d(147)][d(216)][d(241)](e=>e.id);A=t[d(260)](e=>t[d(140)+"es"](e)),a=0<c.length}else await Ticket[d(198)+d(166)]({_id:A._id},{$set:{ticketType:i}})}catch(e){}break}}if(t&&t.AutoAlert){var g=parseDuration(t.AutoAlert);if(g){var y,w,v=await m[d(280)+"es"][d(226)]({limit:30}).catch(()=>null);if(v&&!f[d(145)](v[d(286)],0)){let e=Array[d(129)](v[d(283)]()).sort((e,t)=>t[d(256)+"dTimes"+d(272)]-e[d(256)+d(169)+"tamp"]),r=t["Suppor"+d(152)]||[],i=null,n=null,a=null,c=!1,l=!1;for(var p of e)try{var h=f.XWuiG(p[d(137)].id,A.userId),C=p.author.bot||p[d(137)].id===o.user.id;if(!C){h&&(l=!0);let e=!1,t=[];if(!h){var z=p[d(218)][d(164)+"s"][d(216)][d(207)](p[d(137)].id);if(z){var L=z.roles[d(216)].map(e=>e.id);t=L[d(260)](e=>r[d(140)+"es"](e)),e=0<t.length}else try{var T=(await p[d(218)][d(164)+"s"].fetch(p[d(137)].id))[d(147)].cache[d(241)](e=>e.id);t=T.filter(e=>r.includes(e)),e=f.iqZPl(t[d(191)],0)}catch{if("Efdce"===f[d(236)])continue;f=!0}}if(a||(a=p,c=e),e||i?f[d(267)](e,!n)&&(n=p):i=p,i&&n)break}}catch(e){continue}(i||l||c)&&(y=a?u-a["create"+d(169)+d(272)]:0,c&&f.OcZyD(y,g)&&!A.alertMessageId&&(!A["alertT"+d(167)]||A["alertT"+d(167)]<=new Date)?await f[d(289)](triggerAlertCommand,o,m,A):A[d(245)+"essageId"]&&A.alertTime&&u>=A.alertTime&&(w={client:o,guild:m[d(218)],channel:m,user:{id:o[d(143)].id,tag:"/alert",username:o.user[d(270)+"me"]},member:{...await m.guild[d(164)+"s"].fetch(o.user.id),roles:{cache:{some:t=>{var e=d;return(s["Ticket"+e(254)][A.ticketType][e(240)+e(152)]||[])[e(249)](e=>t({id:e}))},map:t=>{var e=d;return(s.TicketTypes[A[e(285)+e(282)]]["Suppor"+e(152)]||[])[e(241)](e=>t({id:e}))}}}},isCommand:()=>!1,reply:async()=>{},deferReply:async()=>{},editReply:async()=>{},followUp:async()=>{}},await f.rjQtk(handleTicketClose,o,w,A[d(285)+"Id"],f.Khkvp)))}}}}}catch(e){f[d(153)]!==f[d(170)]?console[d(296)]("Error proces"+d(185)+"icket "+A._id+":",e):s[d(296)](d(211)+d(238)+d(212)+d(177)+"m:",u)}}catch(e){"HjZvi"===d(193)?console[d(296)](d(211)+"in checkAler"+d(234),e):f[d(296)](d(181)+"] Tick"+d(204)+d(197)+d(173)+d(194)+" slashCommands")}}function startAlertScheduler(e){let t=U,r={AJsyd:function(e,t){return e(t)}};config[t(161)]&&config[t(161)].Enabled&&setInterval(()=>{r.AJsyd(checkAlerts,e)},6e4),setInterval(()=>{r.AJsyd(checkAutoUnclaim,e)},6e4)}function b(n,e){let c=a();return(b=function(e,t){e-=129;let r=c[e];void 0===b.gGIfRX&&(b.kjeRtL=function(n){let a="",r="";for(let e=0,t,r,i=0;r=n.charAt(i++);~r&&(t=e%4?64*t+r:r,e++%4)&&(a+=String.fromCharCode(255&t>>(-2*e&6))))r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let e=0,t=a.length;e<t;e++)r+="%"+("00"+a.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(r)},n=arguments,b.gGIfRX=!0);var e=e+c[0],i=n[e];return i?r=i:(r=b.kjeRtL(r),n[e]=r),r})(n,e)}module[U(264)+"s"]={startAlertScheduler:startAlertScheduler};