let H=b,{ChannelType,EmbedBuilder,PermissionsBitField}=((()=>{for(var e=b,n=a();;)try{if(758253==-parseInt(e(445))*(parseInt(e(394))/2)+parseInt(e(465))/3*(parseInt(e(417))/4)+parseInt(e(367))/5*(parseInt(e(461))/6)+-parseInt(e(365))/7*(-parseInt(e(416))/8)+-parseInt(e(414))/9+-parseInt(e(410))/10*(parseInt(e(453))/11)+-parseInt(e(370))/12)break;n.push(n.shift())}catch(e){n.push(n.shift())}})(),require(H(473)+H(423))),fs=require("fs"),yaml=require(H(396)+"l"),moment=require(H(454)+"-timez"+H(418)),{getConfig,getLang,replacePlaceholders:globalReplacePlaceholders}=require("../utils/core/configLoader"),getLogChannel=require(H(412)+H(484)+H(469)+H(400)+"eUtils.js").getLogChannel,config=getConfig(),lang=getLang(),handleVoiceXP=require("./Levels/han"+H(397)).handleVoiceXP;function b(i,e){let c=a();return(b=function(e,n){e-=361;let r=c[e];void 0===b.jfwXPS&&(b.khlgub=function(i){let a="",r="";for(let e=0,n,r,t=0;r=i.charAt(t++);~r&&(n=e%4?64*n+r:r,e++%4)&&(a+=String.fromCharCode(255&n>>(-2*e&6))))r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let e=0,n=a.length;e<n;e++)r+="%"+("00"+a.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(r)},i=arguments,b.jfwXPS=!0);var e=e+c[0],t=i[e];return t?r=t:(r=b.khlgub(r),i[e]=r),r})(i,e)}function parseTime(e){var n=H,r={sUGzn:function(e,n){return e*n},wXYCz:function(e,n){return e*n}},e=e.match(/^(\d+)([smhd])$/);if(!e)return 0;var t=parseInt(e[1]);switch(e[2]){case"s":return 1e3*t;case"m":return 1e3*r[n(452)](t,60);case"h":return 1e3*r[n(431)](60*t,60);case"d":return r[n(431)](24*t*60*60,1e3);default:return 0}}let activeVoiceUsers=new Map,voiceXpInterval=null;function startVoiceXPSystem(i){let e=H,a={FrCzN:"ouHDK"};var n;voiceXpInterval||(n=parseTime(config[e(362)+e(434)+"em"].CooldownSettings.VoiceInterval||"60s"),n=Math.max(n,3e4),voiceXpInterval=setInterval(async()=>{var n,r,t=e;if(0!==activeVoiceUsers[t(439)])for([n,r]of Array.from(activeVoiceUsers[t(457)+"s"]())[t(380)](0,75))try{if("VNXNj"!==a.FrCzN){if(r&&r.guild){let e=await r.guild.members[t(433)](n)[t(403)](()=>null);e&&e[t(411)]?.[t(455)+"l"]?(activeVoiceUsers.set(n,e),await handleVoiceXP(i,e)):activeVoiceUsers[t(406)](n)}}else n[t(363)](t(374)+t(395)+t(369)+"oice X"+t(468)+"member "+r+":",j),k.delete(l)}catch(e){t(377)!==t(435)?(console.error("Error "+t(395)+t(369)+t(382)+"P for "+t(421)+" "+n+":",e),activeVoiceUsers.delete(n)):(r[t(398)](j.member.id,k[t(421)]),e||o(p))}},n))}function stopVoiceXPSystem(){voiceXpInterval&&(clearInterval(voiceXpInterval),voiceXpInterval=null),activeVoiceUsers.clear()}async function handleVoiceStateUpdate(e,n,r){var t=H;try{handleVoiceXPEvents(e,n,r);var i=getVoiceStateConfig(n,r);i&&await sendVoiceStateEmbed(n,r,i)}catch(e){console.error(t(374)+"in voi"+t(466)+t(462)+"e event:",e)}}function getVoiceStateConfig(e,n){var r=H,t={BKxpZ:"xfGiq",cuoCU:r(425)+"hannel"+r(438),PdBAq:function(e,n){return e!==n},FMgnA:r(425)+r(428)+"Switch"};if(null===e[r(455)+"lId"]&&null!==n["channe"+r(464)]&&config[r(425)+"hannel"+r(381)]&&config[r(425)+"hannelJoin"].Enabled)return"VoiceC"+r(428)+"Join";if(null!==e[r(455)+r(464)]&&null===n[r(455)+r(464)]&&config[r(425)+r(428)+r(438)]&&config["VoiceC"+r(428)+"Leave"].Enabled)return"PKCBT"!==t[r(408)]?t[r(459)]:"VoiceC"+r(428)+r(381);if(t[r(389)](e[r(455)+"lId"],n[r(455)+r(464)])&&null!==e[r(455)+"lId"]&&t.PdBAq(n["channe"+r(464)],null)&&e.member.id===n[r(421)].id&&config["VoiceC"+r(428)+"Switch"]&&config["VoiceC"+r(428)+r(426)][r(361)+"d"])return t[r(483)];if(e.streaming!==n.streaming){if(n["stream"+r(390)]&&config[r(425)+"hannelStream"+r(388)]&&config.VoiceChannelStreamStart.Enabled)return r(425)+"hannelStreamStart";if(!n[r(373)+"ing"]&&config[r(425)+r(428)+r(481)+"Stop"]&&config["VoiceChannelStream"+r(477)][r(361)+"d"])return r(425)+"hannel"+r(481)+r(477)}return null}function replacePlaceholders(e,n,r,t=null){var i=H,a={gEerp:"MMMM D"+i(391)},c=moment().tz(config[i(441)+"ne"]),o=c[i(366)](i(470)),c=c[i(366)](a.gEerp),a=n.channel?n[i(455)+"l"][i(432)]:i(415),n=r.channel?r.channel[i(432)]:i(415),l=r.channelId?n:a;return e[i(446)+"e"](/{user}/g,r[i(421)]?"<@"+r[i(421)].id+">":i(378))[i(446)+"e"](/{moderator}/g,t?"<@"+t.id+">":"N/A")[i(446)+"e"](/{oldChannel}/g,a).replace(/{newChannel}/g,n).replace(/{channel}/g,l)[i(446)+"e"](/{shorttime}/g,o).replace(/{longtime}/g,c)}async function sendVoiceStateEmbed(n,r,e,t=null){var i=H,a={sqYnt:function(e,n){return e===n},blyBl:function(e,n,r,t,i){return e(n,r,t,i)}};if(e){var c=config[e],e=lang[e].Embed,o=(new EmbedBuilder)[i(471)+"or"](e[i(372)])[i(383)+"le"](a[i(387)](replacePlaceholders,e[i(436)],n,r,t))[i(472)+"cription"](e["Descri"+i(371)].map(e=>replacePlaceholders(e,n,r,t)).join("\n")),a=(e[i(451)].Text&&o[i(413)+"ter"]({text:globalReplacePlaceholders(e[i(451)].Text),iconURL:e[i(451)][i(401)]||void 0}),e.Author.Text&&o[i(437)+i(422)]({name:e[i(442)][i(447)],iconURL:e[i(442)].Icon||void 0}),e[i(448)+i(429)]&&r.member&&o["setThu"+i(482)](r.member[i(405)][i(392)+"yAvata"+i(399)]()),e.Image&&("JFmci"===i(404)?t.push([a,c]):o[i(420)+"ge"](e.Image)),getLogChannel(r.guild,c[i(480)+i(385)+"D"]));if(a)try{await a.send({embeds:[o]})}catch(e){console[i(363)](i(374)+"sendin"+i(463)+i(440)+i(474)+"d:",e)}}}function a(){let e=["C2z1C28","AgfUBMvS","ywLS","zNjVBq","D1Hzq3O","BMfTzq","zMv0y2G","BMDtExn0","Eg13D0C","vgL0Bgu","C2v0qxv0","tgvHDMu","C2L6zq","zsbZDgf0","vgLTzxPV","qxv0Ag9Y","zw1IzxiG","vfnPwhO","muvftNvnyW","CMvWBgfJ","vgv4Da","vgH1BwjU","wgfkq0O","igr1CMLU","rM9VDgvY","C1vhEM4","mtq2ndeZodvhvvnrr2O","Bw9Tzw50","y2HHBM5L","sxrzyxu","zw50CMLL","Du90qvC","y3vVq1u","EgPqDei","mJr5zeH4rKW","zvvWzgf0","zYb2B2LJ","BeLK","ndy3mte4CevsuuH1","y2vtDgf0","C3fzBNq","ucbMB3iG","zgXLCNmV","seG6Bw0","C2v0q29S","C2v0rgvZ","zgLZy29Y","zsbLBwjL","yMXeEMu","zsbLDMvU","u3rVCa","zM9YrwfJ","u0Lhsu5u","tg9NC0nO","u3rYzwfT","BwjUywLS","rK1NBKe","BhmVAgfU","rw5HyMXL","tgv2zwXP","zxjYB3i","BNvWoG","mJyWntrUr25Hqxq","zM9YBwf0","mtq2nZmZmerKzerxua","EhDksNi","C2LUzYb2","ndC1ntq1nMXkCwv6zG","ChrPB24","q29SB3i","C3rYzwfT","rxjYB3iG","wefisvi","wLf1tfq","wvHZqMe","tI9b","y05QAhC","C2XPy2u","sM9PBG","B2LJzsby","C2v0vgL0","sxDbAxC","yw5UzwXj","DMfSAwrH","yMX5qMW","u3rHCNq","ugrcqxe","Aw5N","BYbzwvLz","zgLZCgXH","DgLUzYbT","mtiXotK0vKLVq0fx","ChjVy2vZ","ANmTEwfT","zgXLwfa","C2v0","CLvsta","BwvZC2fN","swnVBG","zxHWB3j0","y2f0y2G","tuvHELu","DxnLCG","zgvSzxrL","DKzID3G","qKT4CfO","zYbJBgvH","mtb2t1vTBNm","DM9Py2u","lI4VDxrP","C2v0rM9V","mtG2mdaYmwjNC2nLrW","tM9Uzq","mJa1nKDfwxPxDa","mtzqvNHmBvC","B25L","z3vPBgq","C2v0sw1H","BwvTyMvY","Ag9Y","zc5QCW","C2v0vgH1","vM9Py2vd","u3DPDgnO"];return(a=function(){return e})()}function handleVoiceXPEvents(e,n,r){var t=H,i={xjPtB:"Error in voiceStat"+t(462)+t(476)+"t:",sfuso:function(e,n){return e*n},blDze:function(e,n){return e*n},TSiXz:function(e,n){return e*n},XAHIR:function(e,n){return e*n},UHnJm:function(e,n){return e*n},xwJJr:t(379),ePUcg:function(e,n){return e!==n},YdaVr:"qgyXa",uOtAW:t(384),ZQuLT:function(e,n){return e===n}};if(!n.channel&&r[t(455)+"l"])"cNjhw"===i[t(368)]?r.member&&("vFbwx"!==t(407)?r.error(i[t(460)],i):(activeVoiceUsers[t(398)](r.member.id,r[t(421)]),voiceXpInterval||startVoiceXPSystem(e))):(i(g),h=null);else if(n.channel&&!r[t(455)+"l"]){if(i.ePUcg(i.YdaVr,"qgyXa"))r[t(424)+t(482)](i.member[t(405)][t(392)+"yAvata"+t(399)]());else if(n[t(421)])if("IwAiw"!==i[t(458)])r(i);else if(activeVoiceUsers[t(406)](n[t(421)].id),i[t(376)](activeVoiceUsers.size,0))if(i.ePUcg("kSwhT","wQgcN"))stopVoiceXPSystem();else{e=r.match(/^(\d+)([smhd])$/);if(!e)return 0;var a=i(e[1]);switch(e[2]){case"s":return i[t(427)](a,1e3);case"m":return 60*a*1e3;case"h":return i[t(475)](60*i[t(444)](a,60),1e3);case"d":return i[t(375)](60*i.UHnJm(24*a,60),1e3);default:return 0}}}else n["channe"+t(464)]!==r[t(455)+t(464)]&&(r[t(421)]&&r[t(455)+"l"]?activeVoiceUsers[t(398)](r.member.id,r[t(421)]):n[t(421)]&&!r[t(455)+"l"]&&activeVoiceUsers[t(406)](n.member.id))}setInterval(async()=>{let t=H,e={XaJCJ:"MSeJr",OlvoY:function(e,n){return e===n}};if(200<activeVoiceUsers.size){var n,r,i=[];for([n,r]of Array[t(430)](activeVoiceUsers.entries()))try{if("EREuW"===e[t(449)])n[t(363)](t(374)+t(386)+t(393)+"ember "+r+(t(450)+t(409)+t(364)),h);else if(r&&r.guild){var a=await r[t(419)].members.fetch(n)[t(403)](()=>null);if(a&&a[t(411)]?.[t(455)+"l"]){if(!e.OlvoY("ItYau",t(456)))return"VoiceChannel"+t(481)+t(477);i.push([n,a])}}}catch(e){console[t(363)](t(374)+"valida"+t(393)+t(443)+n+" during clea"+t(364),e)}activeVoiceUsers.clear(),i[t(478)+"h"](([e,n])=>{var r=t;activeVoiceUsers[r(398)](e,n)})}},12e4),process.on("SIGTERM",()=>{stopVoiceXPSystem()}),process.on(H(479),()=>{stopVoiceXPSystem()}),module[H(402)+"s"]=handleVoiceStateUpdate;