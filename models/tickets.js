let i=b,mongoose=((()=>{for(var e=b,t=a();;)try{if(735404==-parseInt(e(232))+-parseInt(e(239))/2+parseInt(e(219))/3+parseInt(e(222))/4*(-parseInt(e(228))/5)+-parseInt(e(216))/6*(parseInt(e(246))/7)+-parseInt(e(243))/8*(parseInt(e(235))/9)+parseInt(e(220))/10)break;t.push(t.shift())}catch(e){t.push(t.shift())}})(),require(i(238)+"se")),attachmentSchema=new mongoose.Schema({url:String,proxyURL:String,contentType:String,name:String,id:String,timestamp:Date,binaryData:{type:Buffer,required:!1},width:Number,height:Number,size:Number,compressed:{type:Boolean,default:!1}}),messageSchema=new mongoose[i(215)]({author:String,authorId:String,content:String,timestamp:Date,attachments:[attachmentSchema]}),questionSchema=new mongoose[i(215)]({question:{type:String,required:!0},answer:{type:String,required:!0}}),ticketSchema=new mongoose[i(215)]({ticketId:{type:Number,required:!0,unique:!0},userId:{type:String,required:!0},channelId:{type:String,required:!0},channelName:String,guildId:{type:String,required:!0},ticketType:{type:String,required:!0},status:{type:String,default:"open"},priority:String,rating:{type:String,default:"No Rat"+i(221)+"t"},reviewFeedback:{type:String,default:""},reviewData:{type:mongoose[i(215)][i(225)].Mixed,default:{}},averageRating:{type:String,default:"N/A"},messageCount:Number,messages:{type:[messageSchema],default:[]},attachments:{type:[attachmentSchema],default:[]},logMessageId:String,alertMessageId:String,questions:{type:[questionSchema],default:[]},createdAt:{type:Date,default:Date[i(224)]},closedAt:Date,closedBy:{type:String,default:null},alertTime:Date,firstMessageId:{type:String},claimed:{type:Boolean,default:!1},claimedBy:{type:String,default:null},closeReason:{type:String,default:null},customCloseReason:{type:String,default:null},alertReason:{type:String,default:"No rea"+i(241)+"ovided"},channelTopic:{type:String,default:""},processingClaim:{type:Boolean,default:!1},lastStaffResponse:{type:Date,default:null},watchers:{type:[String],default:[]},closeRequestPending:{type:Boolean,default:!1},closeRequestBy:{type:String,default:null},closeRequestReason:{type:String,default:null},closeRequestAt:{type:Date,default:null},closeRequestMessageId:{type:String,default:null}});function a(){let e=["y3jLyxrL","y29UBMvJ","mtm1rvHpr3zV","sw5KzxHL","y29Kzq","Bw9Uz29V","mJCZnZK4nfPsDg14rG","sw5KzxG","C29UihbY","DgLVBG","mJm5mJqWzK1Ly2zi","C190zxH0","y29SBgvJ","otyWngTMEg9wqq","u2nOzw1H","nJqYyM54uKHp","DgLJA2v0","A2v0vhLW","mJC4mtu3u0zcDfnJ","ndGXmtyYmJbytMrnzeu","Aw5NifLL","mZK2mdu2tfnoD1Pg","DcbPBMrL","BM93","vhLWzxm","Dgv4Da","zxnZywDL","ndvxExnSrMW","vgLJA2v0","Aw5KzxG","CY5JB250","mtmXmZq0mg9XDwrkzW"];return(a=function(){return e})()}ticketSchema[i(230)]({status:1,createdAt:-1}),ticketSchema.index({userId:1,createdAt:-1}),ticketSchema[i(230)]({ticketType:1,status:1}),ticketSchema[i(230)]({priority:1,status:1}),ticketSchema.index({claimed:1,claimedBy:1}),ticketSchema.index({createdAt:-1});let Ticket=mongoose.model(i(229),ticketSchema);async function ensureTextIndex(){var t=i,e={GFkIj:"channelName_text_m"+t(227)+t(231)+"ent_text_tic"+t(218)+"e_text",GlvNY:"text"};try{var n=mongoose[t(234)+"tion"][t(245)+t(242)](t(217)+"s");try{await n.dropIndex(e.GFkIj)}catch(e){e[t(237)]}await n[t(233)+t(240)]({channelName:e.GlvNY,"messages.content":t(226),userId:"text",ticketType:t(226)},{weights:{"messages.content":10,userId:8,ticketType:6,channelName:4},name:t(217)+t(244)+"_search",background:!0})}catch(e){console.error("Error managing tex"+t(223)+"x:",e)}}function b(r,e){let i=a();return(b=function(e,t){e-=215;let n=i[e];void 0===b.xkwHFm&&(b.XZsRlm=function(r){let i="",n="";for(let e=0,t,n,a=0;n=r.charAt(a++);~n&&(t=e%4?64*t+n:n,e++%4)&&(i+=String.fromCharCode(255&t>>(-2*e&6))))n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(let e=0,t=i.length;e<t;e++)n+="%"+("00"+i.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(n)},r=arguments,b.xkwHFm=!0);var e=e+i[0],a=r[e];return a?n=a:(n=b.XZsRlm(n),r[e]=n),n})(r,e)}mongoose["connec"+i(242)].once("connected",async()=>{var e=i;try{await ensureTextIndex(),await Ticket["create"+e(236)+"s"]()}catch(e){}}),module.exports=Ticket;