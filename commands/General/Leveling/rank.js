let b5=b,{SlashCommandBuilder,AttachmentBuilder,MessageFlags}=((()=>{for(var e=b,r=a();;)try{if(949937==-parseInt(e(345))+-parseInt(e(253))/2*(-parseInt(e(408))/3)+-parseInt(e(228))/4+parseInt(e(298))/5*(-parseInt(e(276))/6)+parseInt(e(229))/7*(-parseInt(e(239))/8)+-parseInt(e(280))/9+-parseInt(e(241))/10*(-parseInt(e(287))/11))break;r.push(r.shift())}catch(e){r.push(r.shift())}})(),require("discor"+b5(323))),Canvas=require(b5(405)),UserData=require(b5(235)+b5(318)+b5(378)+"erData"),fs=require("fs"),path=require("path"),{getConfig,getLang,getCommands}=require(b5(235)+"../uti"+b5(349)+b5(339)+b5(361)+"er.js"),config=getConfig();function a(){let e=["zMLSBa","ntC5mZu2mtryC25OwKW","C2v0uMvX","y2XPCa","qMX1CG","BgvK","tgv2zwXu","igXLDMvS","zxbSEq","C2v0rgvZ","CMvZDg9Y","BwLUyxrV","nvLQBxH6qG","Dg9tDhjP","mJrWEcbZ","mhb4ihnH","Aw1Hz2vt","r2vUzxjH","zMLSBfrL","mdqW","q29SB3i","DxnLCG","CMfS","yNvMzMvY","uhjVz3jL","zgLZy3jP","yxjJ","B2n1BwvU","CxvHzhjH","qwXWAge","C2f2zq","DgfYoG","lI4VBw9K","Bgv2zwW","ugzOChq","rfzMC2K","zxiGD2HV","zc5QCW","suTjEwC","DgLUzYbY","ywrKq29S","C3rYB2TL","zg9Uj3qG","Bwf4","uMfUA1rL","BIbSyxrL","BwvHC3vY","u3r5Bgu","zsbHBNKG","yM9Szca0","z2XVyMfS","Bgv2zwWG","ruLvuMe","zs9JB25M","wffjufO","BM93","zJe1","y2XVC2vq","AgvPz2H0","oda4mdy3t2fVrej4","jhHW","Bg9HzeLT","vgv4DenV","BhmVy29Y","CKnHC2u","zsb5B3uG","Dg9mB2nH","zgvSzxrL","r3jHzgLL","z2vUzxjH","D2LKDgG","yxnLihrY","BgLUzvDP","vurwAKO","ieXLDMvS","AwDmB2fK","CK9WDgLV","ywXS","C2uGCMfU","ifjHBMSG","yxjYyxLc","yxrO","Ehj6uhy","rhvUyvO","iZbHmgeW","uMfUA0nH","vgrHC2u","Axr5","DMvuBW","B3jtDg9W","rM9YBxvS","DhjHBNnS","zwXZl1vZ","ifHq","DxnLCKLK","yMvNAw5q","tgLUzwfY","C3ncyxi","igrVzxnU","DgHLihjH","zc4GugXL","uMfUAW","wfbozwvK","rxbOzw1L","sxqGBg9V","rLPetMS","vujsBhG","DhLtEhO","AwLhDwO","tgv2zwXP","qwTyqxG","rvPyCK8","BgvHBG","zxjYB3i","rxjYB3iG","DvnxrNm","y2rhChe","CM90yxrL","z3vPBgq","y2fUDMfZ","wuDqA0e","z2v0","odDjDfz0ufa","zhrO","Agf2zsbH","ywDL","Bg1tCxC","igvYCM9Y","Bg9YCW","B3b0Aw9U","zMLUze9U","i0zgrKzg","mZC3odaWmfDjwezTEG","mtu0vfbcuNjS","ic8G","C2HHzg93","rw1VAMLZ","iZe0mtqX","u2vJB25K","lI4VlI4V","ENzKsgG","z2v0vxnL","q2fUDMfZ","ntuYmda4zfHQBfj4","zMLSBfjL","mtbAuLDYDLq","DxnLCM5H","zMLSBfn0","CMvWBgfJ","EwXL","AYb0BYbJ","BwLU","C1rNyMe","y3jLyxrL","uM5PCgq","vgHLCMuG","C2vSzwn0","mti1mJG2sffsrfPy","iZG4odG4","EsbHz2fP","ytmW","rNDvrLy","DgLUzYby","DwLYzwq","zwTmAhi","qvPItve","zvPRB2G","zM9YrwfJ","zw50CMLL","DgLJq3vY","yw1W","vg9WuMfU","zMv0y2HP","u2vdrK8","iZaWmda","C2v0tMfT","BMSGy2fY","BgLUzvrV","BNmTC2vY","BMDtExn0","mteZnJm1ntzQtxrTA1e","BMqGEha","zNjVBq","D1PKufi","odCYmtyYmvHbBw1KBa","zvrLEhq","zM9UDa","zM9SBg93","EeHHwgy","i2zMzMzM"];return(a=function(){return e})()}function calculateXPNeeded(c){let b6=b5,d={Pfhpt:function(e,r){return e===r},AZbMQ:function(e,r){return e+r}};if(d[b6(320)](c,0))return 70;if(config.LevelingSystem.UseFormula&&config.LevelingSystem[b6(376)+"a"])try{let e=config.LevelingSystem.Formula[b6(244)+"e"](/\{level\}/g,d.AZbMQ(c,1)[b6(299)+"ng"]()),f=eval(e.replace(/\^/g,"**"));return Math[b6(329)](1,Math.floor(f))}catch(g){return console.error(b6(400)+"evalua"+b6(258)+"P formula:",g),(c+1)*config[b6(395)+b6(275)+"em"][b6(388)+"ed"]}return d[b6(261)](c,1)*config.LevelingSystem.XPNeeded}let avatarCache=new Map,rankCache=new Map,CACHE_DURATION=3e5;function b(n,e){let i=a();return(b=function(e,r){e-=220;let t=i[e];void 0===b.FeHHrP&&(b.SFHoaf=function(n){let i="",t="";for(let e=0,r,t,a=0;t=n.charAt(a++);~t&&(r=e%4?64*r+t:t,e++%4)&&(i+=String.fromCharCode(255&r>>(-2*e&6))))t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(t);for(let e=0,r=i.length;e<r;e++)t+="%"+("00"+i.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(t)},n=arguments,b.FeHHrP=!0);var e=e+i[0],a=n[e];return a?t=a:(t=b.SFHoaf(t),n[e]=t),t})(n,e)}function createGradient(e,r,t,a,n,i){let f=b5,o=e[f(249)+f(382)+f(354)+"nt"](r,t,a,n);return i[f(263)+"h"](([e,r])=>o["addCol"+f(375)](e,r)),o}function roundRect(e,r,t,a,n,i){var f=b5,o={Rnipd:function(e,r){return e-r},iiGuj:function(e,r){return e+r},GOiSf:function(e,r){return e+r}};e[f(381)+"ath"](),e.moveTo(r+i,t),e[f(273)](o[f(250)](r+a,i),t),e[f(314)+"ticCur"+f(374)](r+a,t,r+a,t+i),e.lineTo(o[f(394)](r,a),o[f(394)](t,n)-i),e["quadra"+f(265)+"veTo"](o.GOiSf(r,a),t+n,o.Rnipd(r+a,i),t+n),e[f(273)](r+i,o.iiGuj(t,n)),e[f(314)+f(265)+"veTo"](r,o.iiGuj(t,n),r,t+n-i),e.lineTo(r,t+i),e["quadra"+f(265)+"veTo"](r,t,r+i,t),e.closePath()}async function fetchAvatar(e,r){var a=b5,n={qEoid:function(e,r){return e+r},zvdHh:function(e,r){return e+r},YMxMX:a(396)},r=r+"-"+e,i=avatarCache.get(r);if(i&&Date[a(341)]()-i.timestamp<CACHE_DURATION){if(n.YMxMX!==a(284))return i[a(309)];try{var f=s[a(395)+"ngSystem"].Formula[a(244)+"e"](/\{level\}/g,n.qEoid(t,1)[a(299)+"ng"]()),o=u(f.replace(/\^/g,"**"));return v.max(1,w.floor(o))}catch(e){return A[a(399)]("Error evalua"+a(258)+"P formula:",e),n[a(236)](B,1)*C[a(395)+a(275)+"em"][a(388)+"ed"]}}try{var l=await(await fetch(e))[a(366)+"uffer"]();return avatarCache.set(r,{buffer:Buffer[a(278)](l),timestamp:Date[a(341)]()}),Buffer.from(l)}catch(e){throw console.error("Error "+a(268)+"ng ava"+a(317),e),e}}async function getRank(e,r){var t=b5,a={ekLhr:function(e,r){return e-r},wZdPR:function(e,r){return e+r}},n=r+"-"+e,i=rankCache[t(407)](n);return i&&a[t(260)](Date.now(),i["timest"+t(266)])<CACHE_DURATION?i.rank:(i=await UserData.findOne({userId:e,guildId:r},{level:1,xp:1}).lean())?(e=1e6*i.level+i.xp,i=await UserData["countD"+t(313)+"ts"]({guildId:r,$expr:{$gt:[{$add:[{$multiply:["$level",1e6]},t(346)]},e]}}),r=a[t(279)](i,1),rankCache.set(n,{rank:r,timestamp:Date[t(341)]()}),r):0}async function generateRankCard(e,r,t){let n=b5,i={YGPkA:function(e,r){return e/r},DVfsi:function(e,r){return e*r},UBRlx:n(227)+"F",FZDNk:n(233)+"4",FrRsK:"#0a0a0a",efrWT:"#0000",UDVjJ:"#7289d"+n(256),DunaZ:function(e,r,t,a){return e(r,t,a)},ldSDc:function(e,r){return e-r},XQIPZ:function(e,r,t,a){return e(r,t,a)},hkLhP:function(e,r){return e-r},xrzPv:function(e,r){return e*r},tySxz:function(e,r){return e*r},cdGpq:n(300)+"ans-serif",Tdase:function(e,r){return e+r},ykmdh:"bold 3"+n(301)+n(274)+"if",hHrKL:function(e,r){return e<=r},FwUFV:function(e,r){return e+r},sAiVB:n(285)+"f10",SeCFO:"#ffffff05",lmSqw:function(e,r,t,a,n,i,f){return e(r,t,a,n,i,f)},FMYPg:function(e,r){return e+r},IKIyg:"#fffff"+n(342),sTgba:"#ffffff"},a=Canvas["create"+n(238)](1e3,300),f=a.getContext("2d"),o=config[n(371)+"rd"]?.["Accent"+n(306)]||"#1769FF",u=config.RankCard?.[n(234)+"aryColor"]||"#4785FF",l=config[n(371)+"rd"]?.[n(310)+n(383)]?.StartColor||o,s=config.RankCard?.ProgressBar?.EndColor||u,c=config[n(371)+"rd"]?.[n(348)+"lors"]?.[n(292)+"ext"]||i.UBRlx,g=config[n(371)+"rd"]?.[n(348)+n(224)]?.[n(330)+"xt"]||i[n(392)],d=config.RankCard?.[n(348)+"lors"]?.Numbers||n(227)+"F",v=config.RankCard?.[n(232)]?.Level||"âœ§",h=config[n(371)+"rd"]?.Emojis?.[n(267)+"k"]||"ðŸ‘‘",C=config[n(371)+"rd"]?.Emojis?.["Normal"+n(387)]||"â­";f["imageSmoothingEnab"+n(291)]=!0,f[n(302)+"moothingQual"+n(373)]="high";var m=createGradient(f,0,0,a.width,a.height,[[0,n(370)+"a"],[.4,i.FZDNk],[.6,i[n(391)]],[1,i.FrRsK]]);f[n(243)+"yle"]=m,f[n(240)+"ct"](0,0,a.width,a.height),f.save(),f.globalAlpha=.05;for(let e=0;e<a[n(356)]+a.height;e+=45)f[n(381)+n(367)](),f.moveTo(0,e),f[n(273)](e,0),f["stroke"+n(333)]=n(285)+"f",f["lineWi"+n(409)]=2,f.stroke();f[n(296)+"e"](),f.save(),f[n(336)+n(315)]=.1,f["fillSt"+n(245)]=createGradient(f,a[n(356)]/2,0,i.YGPkA(a.width,2),a[n(344)],[[0,i.efrWT],[.5,i[n(359)]],[1,n(270)]]),f[n(240)+"ct"](0,0,a[n(356)],a[n(344)]),f.restore();var[m,e]=await Promise[n(363)]([fetchAvatar(t.displayAvatarURL({extension:"png",size:256}),t.id),getRank(t.id,e[n(404)].id)]);f[n(316)]();function w(e,r,t){var a=n,e=(f.save(),f[a(377)+"ate"](e,r),f[a(403)](i[a(406)](i[a(321)](t,90)*Math.PI,180)),f[a(381)+a(367)](),f[a(358)+"dth"]=3,f[a(249)+"LinearGradient"](0,0,40,40));e["addCol"+a(375)](0,o),e[a(326)+a(375)](1,o+"00"),f[a(327)+a(333)]=e,f.moveTo(0,40),f.lineTo(0,0),f[a(273)](40,0),f[a(231)+"Color"]=o,f[a(231)+a(290)]=8,f.stroke(),f[a(296)+"e"]()}w(20,20,0),i[n(369)](w,i.ldSDc(a[n(356)],20),20,1),w(20,a[n(344)]-20,3),i[n(340)](w,a.width-20,i.hkLhP(a[n(344)],20),2),f[n(296)+"e"]();f.save(),f[n(381)+"ath"](),f.arc(120,150,90,0,i[n(368)](Math.PI,2)),f[n(231)+n(306)]=o,f.shadowBlur=25,f.strokeStyle=o,f[n(358)+n(409)]=3,f[n(327)](),f.beginPath(),f[n(312)](120,150,85,0,i[n(393)](Math.PI,2)),f["stroke"+n(333)]=u,f[n(358)+n(409)]=2,f[n(327)](),f[n(296)+"e"]();var m=await Canvas[n(347)+"age"](m),m=(f.save(),f[n(381)+n(367)](),f[n(312)](120,150,80,0,2*Math.PI),f[n(343)+n(367)](),f[n(289)](),f["drawIm"+n(221)](m,40,70,160,160),f.fillStyle=o+"15",f[n(286)](),f[n(296)+"e"](),f.save(),f.shadowColor=o,f[n(231)+"Blur"]=15,f[n(243)+n(245)]=n(285)+"f",f.font=n(335)+"4px sa"+n(274)+"if",t[n(242)+"me"]["toUppe"+n(350)]()),z=f[n(332)+"eText"](m).width,m=(f[n(304)+"xt"](m,260,100),"0"!==t[n(311)+n(297)+"r"]&&(f.font=i[n(402)],f["fillSt"+n(245)]=n(254)+"8",f.shadowBlur=0,f[n(304)+"xt"]("#"+t["discri"+n(297)+"r"],i[n(372)](260,z)+5,100)),f.restore(),f[n(316)](),f[n(282)]=i.ykmdh,f.fillStyle=c,f.fillText(v+(n(360)+" "),260,150),f["fillSt"+n(245)]=d,f[n(304)+"xt"](r[n(319)],260+f.measureText(v+(n(360)+" "))[n(356)],150),i.hHrKL(e,3)?h:C),t=(f.fillStyle=g,f[n(304)+"xt"](m+" Rank #",i[n(257)](260,220),150),f[n(243)+"yle"]=d,f.fillText(e,480+f[n(332)+"eText"](m+(n(365)+"#"))[n(356)],150),f[n(296)+"e"](),260),z=200,e=(f[n(316)](),roundRect(f,t,z,650,35,17.5),createGradient(f,t,z,t,235,[[0,"#fffff"+n(342)],[.5,i.sAiVB],[1,i[n(269)]]])),m=(f[n(243)+n(245)]=e,f[n(231)+"Color"]="#00000"+n(305),f.shadowBlur=10,f[n(286)](),f[n(296)+"e"](),calculateXPNeeded(r[n(319)])),e=Math[n(247)](r.xp/m,1),b=i.lmSqw(createGradient,f,t,z,i.FMYPg(t,650),z,[[0,l],[.5,s],[1,l]]),e=(f.save(),roundRect(f,t,z,650*e,35,17.5),f["fillSt"+n(245)]=b,f[n(231)+"Color"]=o+"60",f["shadow"+n(290)]=15,f[n(286)](),i[n(222)](createGradient,f,t,z,t,235,[[0,i[n(324)]],[.5,n(285)+"f00"],[1,"#ffffff10"]])),b=(f["fillSt"+n(245)]=e,f[n(286)](),f.restore(),f.save(),f.fillStyle=i[n(248)],f.font="bold 2"+n(301)+"ns-serif",r.xp[n(352)+"leString"]()+n(230)+m.toLocaleString()+n(379)),z=f[n(332)+n(281)](b).width;return f.shadowColor="#000000",f["shadow"+n(290)]=7,f.fillText(b,t+i.YGPkA(650-z,2),224),f[n(296)+"e"](),a.toBuffer()}setInterval(()=>{var e,r,t=b5,a={EZXrO:"VVIXm"},f=Date.now();for([e,r]of avatarCache.entries())t(262)!==a[t(397)]?f-r["timest"+t(266)]>CACHE_DURATION&&avatarCache[t(353)](e):h-i.timestamp>j&&m.delete(n);for(let[e,r]of rankCache[t(264)+"s"]())f-r["timest"+t(266)]>CACHE_DURATION&&rankCache[t(353)](e)},CACHE_DURATION),module.exports={data:(new SlashCommandBuilder)[b5(271)+"e"]("rank")[b5(295)+"cription"]("Check your level a"+b5(277))["addUse"+b5(362)+"n"](e=>e.setName("user").setDescription("The us"+b5(322)+b5(364)+b5(246)+"heck")[b5(288)+b5(259)](!1)),category:b5(303)+"l",async execute(t){var a=b5,n={uSWFs:a(307)};await t["deferR"+a(294)]();try{var f=t[a(225)+"s"][a(237)+"r"](n[a(401)])||t[a(307)],o=await UserData[a(226)+"e"]({userId:f.id,guildId:t.guild.id})[a(252)](a(380)+a(293)+" xp")[a(398)]();if(!o)return a(338)!==a(338)?r[a(283)+"Up"]({content:i.id===j.user.id?a(390)+"ks lik"+a(351)+a(328)+a(220)+"ny level data.":a(390)+"ks like "+k.username+a(384)+"'t hav"+a(334)+a(337)+"data.",flags:l[a(389)+"ral"]}):t.followUp({content:f.id===t[a(307)].id?"It looks like you don't have any level data.":"It looks like "+f[a(242)+"me"]+" doesn't have any "+a(337)+"data.",flags:MessageFlags["Epheme"+a(308)]});let e=await generateRankCard(t,o,f),r=new AttachmentBuilder(e,{name:"rank-card.png"});await t.followUp({files:[r]})}catch(e){console[a(399)](a(400)+a(355)+a(325)+"ank card:",e),await t.followUp({content:a(251)+"was an"+a(223)+" generating "+a(385)+a(272)+a(386)+a(357)+a(255)+a(331)+"r.",flags:MessageFlags["Epheme"+a(308)]})}}};